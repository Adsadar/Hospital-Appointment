!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).zipy={})}(this,function(e){var t;!function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.ReplayerEvent=11]="ReplayerEvent",e[e.ConsoleInfo=50]="ConsoleInfo",e[e.ConsoleError=51]="ConsoleError",e[e.ConsoleWarning=52]="ConsoleWarning",e[e.ConsoleDebug=53]="ConsoleDebug",e[e.Error=70]="Error",e[e.RangeError=71]="RangeError",e[e.ReferenceError=72]="ReferenceError",e[e.TypeError=73]="TypeError",e[e.SyntaxError=74]="SyntaxError",e[e.URIError=75]="URIError",e[e.EvalError=76]="EvalError",e[e.UnhandledRejection=77]="UnhandledRejection",e[e.BROWSERDATA=100]="BROWSERDATA",e[e.NAVIGATION=101]="NAVIGATION",e[e.Online=102]="Online",e[e.Offline=103]="Offline",e[e.XHR=104]="XHR",e[e.WSOPEN=105]="WSOPEN",e[e.WSCLOSE=106]="WSCLOSE",e[e.WSMESSAGE=107]="WSMESSAGE",e[e.WSERROR=108]="WSERROR",e[e.Fonts=109]="Fonts",e[e.Link=110]="Link",e[e.Css=111]="Css",e[e.Image=112]="Image",e[e.Js=113]="Js",e[e.Media=114]="Media"}(t||(t={}));var n,r,o,i="zipy";!function(e){e[e.POSTENDUSERINFOANDGETUSERCONFIG=0]="POSTENDUSERINFOANDGETUSERCONFIG",e[e.POSTENDUSERINFO=1]="POSTENDUSERINFO",e[e.GETUSERCONFIG=2]="GETUSERCONFIG"}(n||(n={})),function(e){e[e.ANONYMS=0]="ANONYMS",e[e.IDENTIFIED=1]="IDENTIFIED"}(r||(r={})),function(e){e[e.NORECORDING=0]="NORECORDING",e[e.RECORDINGPENDING=1]="RECORDINGPENDING",e[e.RECORDINGSUCCESSFUL=2]="RECORDINGSUCCESSFUL"}(o||(o={}));var a={streamMgrUrl:"https://servicesqa.zipy.ai/sdk-session-manager/v2/enduser-info",registerSessionUrl:"https://servicesqa.zipy.ai/sdk-session-manager/v1/register-sdk-session",sdkVersion:"Beta0.3.5",errorUrl:"divolte.collector",streamMgrRetryCount:5,zipyDeploymentEnviornment:"Production",sdkLoopTime:1e3,ignoreEmptyErros:!0,ignoreLargeResponse:!0,debugLogs:!1,sessionLinkUrl:"https://appqa.zipy.ai"},s=!0;function u(e){s&&console.info(i,e)}function l(e){s&&console.debug(i,e)}function c(e){s&&console.log(i,e)}function d(e){s&&console.error(i,e)}var f,p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)};function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function h(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function y(e){var t,n=null===(t=e)||void 0===t?void 0:t.host;return Boolean(n&&n.shadowRoot&&n.shadowRoot===e)}function g(e){var t=e.maskInputOptions,n=e.type,r=e.maskInputFn,o=e.value||"";return(t[e.tagName.toLowerCase()]||t[n])&&(o=r?r(o):"*".repeat(o.length)),o}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(f||(f={}));var w,S,b=1,I=new RegExp("[^a-z0-9-_:]");function E(e){try{var t=e.rules||e.cssRules;return t?Array.from(t).map(k).join(""):null}catch(e){return null}}function k(e){var t=e.cssText;if(function(e){return"styleSheet"in e}(e))try{t=E(e.styleSheet)||t}catch(e){}return t}var C=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,N=/^(?!www\.|(?:http|ftp)s?:\/\/|[A-Za-z]:\\|\/\/|#).*/,O=/^(data:)([^,]*),(.*)/i;function R(e,t){return(e||"").replace(C,function(e,n,r,o,i,a){var s,u=r||i||a,l=n||o||"";if(!u)return e;if(!N.test(u))return"url("+l+u+l+")";if(O.test(u))return"url("+l+u+l+")";if("/"===u[0])return"url("+l+(((s=t).indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0]+u)+l+")";var c=t.split("/"),d=u.split("/");c.pop();for(var f=0,p=d;f<p.length;f++){var v=p[f];"."!==v&&(".."===v?c.pop():c.push(v))}return"url("+l+c.join("/")+l+")"})}var T,x,z,D,M,_,U=/^[^ \t\n\r\u000c]+/,F=/^[, \t\n\r\u000c]+/;function L(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function A(){var e=document.createElement("a");return e.href="",e.href}function P(e,t,n,r){return"src"===n||"href"===n&&r||"xlink:href"===n&&r&&"#"!==r[0]?L(e,r):"background"!==n||!r||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n&&r?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,o=e.exec(t.substring(n));return o?(n+=(r=o[0]).length,r):""}for(var o=[];r(F),!(n>=t.length);){var i=r(U);if(","===i.slice(-1))i=L(e,i.substring(0,i.length-1)),o.push(i);else{var a="";i=L(e,i);for(var s=!1;;){var u=t.charAt(n);if(""===u){o.push((i+a).trim());break}if(s)")"===u&&(s=!1);else{if(","===u){n+=1,o.push((i+a).trim());break}"("===u&&(s=!0)}a+=u,n+=1}}}return o.join(", ")}(e,r):"style"===n&&r?R(r,A()):"object"===t&&"data"===n&&r?L(e,r):r:L(e,r)}function G(e,t,n){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++)if(t.test(e.classList[r]))return!0;return!(!n||!e.matches(n))||G(e.parentNode,t,n)}return G(e.parentNode,t,n)}function W(e){return void 0===e?"":e.toLowerCase()}function j(e,t){var n,r=t.doc,o=t.map,i=t.blockClass,a=t.blockSelector,s=t.maskTextClass,u=t.maskTextSelector,l=t.skipChild,c=void 0!==l&&l,d=t.inlineStylesheet,p=void 0===d||d,v=t.maskInputOptions,m=void 0===v?{}:v,h=t.maskTextFn,k=t.maskInputFn,C=t.slimDOMOptions,N=t.dataURLOptions,O=void 0===N?{}:N,T=t.inlineImages,x=void 0!==T&&T,z=t.recordCanvas,D=void 0!==z&&z,M=t.onSerialize,_=t.onIframeLoad,U=t.iframeLoadTimeout,F=void 0===U?5e3:U,L=t.keepIframeSrcFn,H=void 0===L?function(){return!1}:L,J=t.preserveWhiteSpace,q=void 0===J||J,V=function(e,t){var n,r,o,i,a=t.doc,s=t.blockClass,u=t.blockSelector,l=t.maskTextClass,c=t.maskTextSelector,d=t.inlineStylesheet,p=t.maskInputOptions,v=void 0===p?{}:p,m=t.maskTextFn,h=t.maskInputFn,y=t.dataURLOptions,b=void 0===y?{}:y,k=t.inlineImages,C=t.recordCanvas,N=t.keepIframeSrcFn;if(a.__sn){var O=a.__sn.id;r=1===O?void 0:O}switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:f.Document,childNodes:[],compatMode:e.compatMode,rootId:r}:{type:f.Document,childNodes:[],rootId:r};case e.DOCUMENT_TYPE_NODE:return{type:f.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:r};case e.ELEMENT_NODE:for(var T=function(e,t,n){if("string"==typeof t){if(e.classList.contains(t))return!0}else for(var r=0;r<e.classList.length;r++)if(t.test(e.classList[r]))return!0;return!!n&&e.matches(n)}(e,s,u),x=function(e){if(e instanceof HTMLFormElement)return"form";var t=e.tagName.toLowerCase().trim();return I.test(t)?"div":t}(e),z={},D=0,M=Array.from(e.attributes);D<M.length;D++){var _=M[D],U=_.name;z[U]=P(a,x,U,W=_.value)}if("link"===x&&d){var F=Array.from(a.styleSheets).find(function(t){return t.href===e.href}),L=null;F&&(L=E(F)),L&&(delete z.rel,delete z.href,z._cssText=R(L,F.href))}if("style"===x&&e.sheet&&!(e.innerText||e.textContent||"").trim().length&&(L=E(e.sheet))&&(z._cssText=R(L,A())),"input"===x||"textarea"===x||"select"===x){var W=e.value;"radio"!==z.type&&"checkbox"!==z.type&&"submit"!==z.type&&"button"!==z.type&&W?z.value=g({type:z.type,tagName:x,value:W,maskInputOptions:v,maskInputFn:h}):e.checked&&(z.checked=e.checked)}if("option"===x&&(e.selected&&!v.select?z.selected=!0:delete z.selected),"canvas"===x&&C)if("2d"===e.__context)(function(e){var t=e.getContext("2d");if(!t)return!0;for(var n=0;n<e.width;n+=50)for(var r=0;r<e.height;r+=50){var o=t.getImageData;if(new Uint32Array(("__rrweb_original__"in o?o.__rrweb_original__:o).call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some(function(e){return 0!==e}))return!1}return!0})(e)||(z.rr_dataURL=e.toDataURL(b.type,b.quality));else if(!("__context"in e)){var j=e.toDataURL(b.type,b.quality),H=document.createElement("canvas");H.width=e.width,H.height=e.height,j!==H.toDataURL(b.type,b.quality)&&(z.rr_dataURL=j)}if("img"===x&&k){w||(w=a.createElement("canvas"),S=w.getContext("2d"));var J=e,q=J.crossOrigin;J.crossOrigin="anonymous";var V=function(){try{w.width=J.naturalWidth,w.height=J.naturalHeight,S.drawImage(J,0,0),z.rr_dataURL=w.toDataURL(b.type,b.quality)}catch(e){console.warn("Cannot inline img src="+J.currentSrc+"! Error: "+e)}q?z.crossOrigin=q:delete z.crossOrigin};J.complete&&0!==J.naturalWidth?V():J.onload=V}if("audio"!==x&&"video"!==x||(z.rr_mediaState=e.paused?"paused":"played",z.rr_mediaCurrentTime=e.currentTime),e.scrollLeft&&(z.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(z.rr_scrollTop=e.scrollTop),T){var B=e.getBoundingClientRect();z={class:z.class,rr_width:B.width+"px",rr_height:B.height+"px"}}return"iframe"!==x||N(z.src)||(e.contentDocument||(z.rr_src=z.src),delete z.src),{type:f.Element,tagName:x,attributes:z,childNodes:[],isSVG:(i=e,Boolean("svg"===i.tagName||i.ownerSVGElement)||void 0),needBlock:T,rootId:r};case e.TEXT_NODE:var Z=e.parentNode&&e.parentNode.tagName,K=e.textContent,Y="STYLE"===Z||void 0,X="SCRIPT"===Z||void 0;if(Y&&K){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(K=(o=e.parentNode.sheet).cssRules?Array.from(o.cssRules).map(function(e){return e.cssText||""}).join(""):"")}catch(t){console.warn("Cannot get CSS styles from text's parentNode. Error: "+t,e)}K=R(K,A())}return X&&(K="SCRIPT_PLACEHOLDER"),!Y&&!X&&G(e,l,c)&&K&&(K=m?m(K):K.replace(/[\S]/g,"*")),{type:f.Text,textContent:K||"",isStyle:Y,rootId:r};case e.CDATA_SECTION_NODE:return{type:f.CDATA,textContent:"",rootId:r};case e.COMMENT_NODE:return{type:f.Comment,textContent:e.textContent||"",rootId:r};default:return!1}}(e,{doc:r,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,inlineStylesheet:p,maskInputOptions:m,maskTextFn:h,maskInputFn:k,dataURLOptions:O,inlineImages:x,recordCanvas:D,keepIframeSrcFn:H});if(!V)return console.warn(e,"not serialized"),null;n="__sn"in e?e.__sn.id:!function(e,t){if(t.comment&&e.type===f.Comment)return!0;if(e.type===f.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&"preload"===e.attributes.rel&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"==typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(W(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===W(e.attributes.name)||"icon"===W(e.attributes.rel)||"apple-touch-icon"===W(e.attributes.rel)||"shortcut icon"===W(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&W(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(W(e.attributes.property).match(/^(og|twitter|fb):/)||W(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===W(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===W(e.attributes.name)||"googlebot"===W(e.attributes.name)||"bingbot"===W(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===W(e.attributes.name)||"generator"===W(e.attributes.name)||"framework"===W(e.attributes.name)||"publisher"===W(e.attributes.name)||"progid"===W(e.attributes.name)||W(e.attributes.property).match(/^article:/)||W(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===W(e.attributes.name)||"yandex-verification"===W(e.attributes.name)||"csrf-token"===W(e.attributes.name)||"p:domain_verify"===W(e.attributes.name)||"verify-v1"===W(e.attributes.name)||"verification"===W(e.attributes.name)||"shopify-checkout-api-token"===W(e.attributes.name)))return!0}}return!1}(V,C)&&(q||V.type!==f.Text||V.isStyle||V.textContent.replace(/^\s+|\s+$/gm,"").length)?b++:-2;var B=Object.assign(V,{id:n});if(e.__sn=B,-2===n)return null;o[n]=e,M&&M(e);var Z=!c;if(B.type===f.Element&&(Z=Z&&!B.needBlock,delete B.needBlock,e.shadowRoot&&(B.isShadowHost=!0)),(B.type===f.Document||B.type===f.Element)&&Z){C.headWhitespace&&V.type===f.Element&&"head"===V.tagName&&(q=!1);for(var K={doc:r,map:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,skipChild:c,inlineStylesheet:p,maskInputOptions:m,maskTextFn:h,maskInputFn:k,slimDOMOptions:C,dataURLOptions:O,inlineImages:x,recordCanvas:D,preserveWhiteSpace:q,onSerialize:M,onIframeLoad:_,iframeLoadTimeout:F,keepIframeSrcFn:H},Y=0,X=Array.from(e.childNodes);Y<X.length;Y++)(ee=j(X[Y],K))&&B.childNodes.push(ee);if(function(e){return e.nodeType===e.ELEMENT_NODE}(e)&&e.shadowRoot)for(var $=0,Q=Array.from(e.shadowRoot.childNodes);$<Q.length;$++){var ee;(ee=j(Q[$],K))&&(ee.isShadow=!0,B.childNodes.push(ee))}}return e.parentNode&&y(e.parentNode)&&(B.isShadow=!0),B.type===f.Element&&"iframe"===B.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var o,i=!1;try{o=r.document.readyState}catch(e){return}if("complete"===o){var a="about:blank";r.location.href===a&&e.src!==a&&""!==e.src?e.addEventListener("load",t):setTimeout(t,0)}else{var s=setTimeout(function(){i||(t(),i=!0)},n);e.addEventListener("load",function(){clearTimeout(s),i=!0,t()})}}}(e,function(){var t=e.contentDocument;if(t&&_){var n=j(t,{doc:t,map:o,blockClass:i,blockSelector:a,maskTextClass:s,maskTextSelector:u,skipChild:!1,inlineStylesheet:p,maskInputOptions:m,maskTextFn:h,maskInputFn:k,slimDOMOptions:C,dataURLOptions:O,inlineImages:x,recordCanvas:D,preserveWhiteSpace:q,onSerialize:M,onIframeLoad:_,iframeLoadTimeout:F,keepIframeSrcFn:H});n&&_(e,n)}},F),B}function H(e,t,n){void 0===n&&(n=document);var r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}!function(e){e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin"}(T||(T={})),function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration"}(x||(x={})),function(e){e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel"}(z||(z={})),function(e){e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2"}(D||(D={})),function(e){e[e.Play=0]="Play",e[e.Pause=1]="Pause",e[e.Seeked=2]="Seeked",e[e.VolumeChange=3]="VolumeChange"}(M||(M={})),function(e){e.Start="start",e.Pause="pause",e.Resume="resume",e.Resize="resize",e.Finish="finish",e.FullsnapshotRebuilded="fullsnapshot-rebuilded",e.LoadStylesheetStart="load-stylesheet-start",e.LoadStylesheetEnd="load-stylesheet-end",e.SkipStart="skip-start",e.SkipEnd="skip-end",e.MouseInteraction="mouse-interaction",e.EventCast="event-cast",e.CustomEvent="custom-event",e.Flush="flush",e.StateChange="state-change",e.PlayBack="play-back"}(_||(_={}));var J="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",q={map:{},getId:function(){return console.error(J),-1},getNode:function(){return console.error(J),null},removeNodeFromMap:function(){console.error(J)},has:function(){return console.error(J),!1},reset:function(){console.error(J)}};function V(e,t,n){void 0===n&&(n={});var r=null,o=0;return function(i){var a=Date.now();o||!1!==n.leading||(o=a);var s=t-(a-o),u=this,l=arguments;s<=0||s>t?(r&&(clearTimeout(r),r=null),o=a,e.apply(u,l)):r||!1===n.trailing||(r=setTimeout(function(){o=!1===n.leading?0:Date.now(),r=null,e.apply(u,l)},s))}}function B(e,t,n,r,o){void 0===o&&(o=window);var i=o.Object.getOwnPropertyDescriptor(e,t);return o.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout(function(){n.set.call(t,e)},0),i&&i.set&&i.set.call(this,e)}}),function(){return B(e,t,i||{},!0)}}function Z(e,t,n){try{if(!(t in e))return function(){};var r=e[t],o=n(r);return"function"==typeof o&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=o,function(){e[t]=r}}catch(e){return function(){}}}function K(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Y(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function X(e,t){if(!e)return!1;if(e.nodeType===e.ELEMENT_NODE){var n=!1;if("string"==typeof t){if(void 0!==e.closest)return null!==e.closest("."+t);n=e.classList.contains(t)}else e.classList.forEach(function(e){t.test(e)&&(n=!0)});return n||X(e.parentNode,t)}return X(e.parentNode,t)}function $(e){return"__sn"in e&&-2===e.__sn.id}function Q(e,t){if(y(e))return!1;var n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||Q(e.parentNode,t))}function ee(e){return Boolean(e.changedTouches)}function te(e){return"__sn"in e&&e.__sn.type===f.Element&&"iframe"===e.__sn.tagName}function ne(e){return Boolean(null==e?void 0:e.shadowRoot)}function re(e){return"__ln"in e}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(q=new Proxy(q,{get:function(e,t,n){return"map"===t&&console.error(J),Reflect.get(e,t,n)}}));var oe=function(){function e(){this.length=0,this.head=null}return e.prototype.get=function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null==t?void 0:t.next)||null;return t},e.prototype.addNode=function(e){var t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&re(e.previousSibling))t.next=n=e.previousSibling.__ln.next,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t);else if(e.nextSibling&&re(e.nextSibling)&&e.nextSibling.__ln.previous){var n;t.previous=n=e.nextSibling.__ln.previous,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,n&&(n.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;this.length++},e.prototype.removeNode=function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next&&(t.next.previous=t.previous)):(this.head=t.next,this.head&&(this.head.previous=null)),e.__ln&&delete e.__ln,this.length--)},e}(),ie=function(e,t){return"".concat(e,"@").concat(t)};function ae(e){return"__sn"in e}var se=function(){function e(){var e=this;this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(t){t.forEach(e.processMutation),e.emit()},this.emit=function(){var t,n,r,o;if(!e.frozen&&!e.locked){for(var i=[],a=new oe,s=function(t){for(var n=t,r=-2;-2===r;)r=(n=n&&n.nextSibling)&&e.mirror.getId(n);return r},u=function(t){for(var n,r,o,u,l,c=t.getRootNode?null===(n=t.getRootNode())||void 0===n?void 0:n.host:null,d=c;null===(o=null===(r=null==d?void 0:d.getRootNode)||void 0===r?void 0:r.call(d))||void 0===o?void 0:o.host;)d=(null===(l=null===(u=null==d?void 0:d.getRootNode)||void 0===u?void 0:u.call(d))||void 0===l?void 0:l.host)||null;var f=!(e.doc.contains(t)||null!==d&&e.doc.contains(d));if(t.parentNode&&!f){var p=y(t.parentNode)?e.mirror.getId(c):e.mirror.getId(t.parentNode),v=s(t);if(-1===p||-1===v)return a.addNode(t);var m=j(t,{doc:e.doc,map:e.mirror.map,blockClass:e.blockClass,blockSelector:e.blockSelector,maskTextClass:e.maskTextClass,maskTextSelector:e.maskTextSelector,skipChild:!0,inlineStylesheet:e.inlineStylesheet,maskInputOptions:e.maskInputOptions,maskTextFn:e.maskTextFn,maskInputFn:e.maskInputFn,slimDOMOptions:e.slimDOMOptions,recordCanvas:e.recordCanvas,inlineImages:e.inlineImages,onSerialize:function(n){te(n)&&e.iframeManager.addIframe(n),ne(t)&&e.shadowDomManager.addShadowRoot(t.shadowRoot,document)},onIframeLoad:function(t,n){e.iframeManager.attachIframe(t,n),e.shadowDomManager.observeAttachShadow(t)}});m&&i.push({parentId:p,nextId:v,node:m})}};e.mapRemoves.length;)e.mirror.removeNodeFromMap(e.mapRemoves.shift());try{for(var l=v(e.movedSet),c=l.next();!c.done;c=l.next())le(e.removes,p=c.value,e.mirror)&&!e.movedSet.has(p.parentNode)||u(p)}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}try{for(var d=v(e.addedSet),f=d.next();!f.done;f=d.next()){var p;ce(e.droppedSet,p=f.value)||le(e.removes,p,e.mirror)?ce(e.movedSet,p)?u(p):e.droppedSet.add(p):u(p)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}for(var m=null;a.length;){var h=null;if(m){var g=e.mirror.getId(m.value.parentNode),w=s(m.value);-1!==g&&-1!==w&&(h=m)}if(!h)for(var S=a.length-1;S>=0;S--){var b=a.get(S);if(b&&(g=e.mirror.getId(b.value.parentNode),w=s(b.value),-1!==g&&-1!==w)){h=b;break}}if(!h){for(;a.head;)a.removeNode(a.head.value);break}m=h.previous,a.removeNode(h.value),u(h.value)}var I={texts:e.texts.map(function(t){return{id:e.mirror.getId(t.node),value:t.value}}).filter(function(t){return e.mirror.has(t.id)}),attributes:e.attributes.map(function(t){return{id:e.mirror.getId(t.node),attributes:t.attributes}}).filter(function(t){return e.mirror.has(t.id)}),removes:e.removes,adds:i};(I.texts.length||I.attributes.length||I.removes.length||I.adds.length)&&(e.texts=[],e.attributes=[],e.removes=[],e.addedSet=new Set,e.movedSet=new Set,e.droppedSet=new Set,e.movedMap={},e.mutationCb(I))}},this.processMutation=function(t){var n,r,o,i;if(!$(t.target))switch(t.type){case"characterData":var a=t.target.textContent;X(t.target,e.blockClass)||a===t.oldValue||e.texts.push({value:G(t.target,e.maskTextClass,e.maskTextSelector)&&a?e.maskTextFn?e.maskTextFn(a):a.replace(/[\S]/g,"*"):a,node:t.target});break;case"attributes":var s=t.target;if(a=t.target.getAttribute(t.attributeName),"value"===t.attributeName&&(a=g({maskInputOptions:e.maskInputOptions,tagName:t.target.tagName,type:t.target.getAttribute("type"),value:a,maskInputFn:e.maskInputFn})),X(t.target,e.blockClass)||a===t.oldValue)return;var u=e.attributes.find(function(e){return e.node===t.target});if(u||e.attributes.push(u={node:t.target,attributes:{}}),"style"===t.attributeName){var l=e.doc.createElement("span");t.oldValue&&l.setAttribute("style",t.oldValue),null==u.attributes.style&&(u.attributes.style={});var c=u.attributes.style;try{for(var d=v(Array.from(s.style)),f=d.next();!f.done;f=d.next()){var p=s.style.getPropertyValue(S=f.value),m=s.style.getPropertyPriority(S);p===l.style.getPropertyValue(S)&&m===l.style.getPropertyPriority(S)||(c[S]=""===m?p:[p,m])}}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}try{for(var h=v(Array.from(l.style)),w=h.next();!w.done;w=h.next()){var S;""===s.style.getPropertyValue(S=w.value)&&(c[S]=!1)}}catch(e){o={error:e}}finally{try{w&&!w.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}}else u.attributes[t.attributeName]=P(e.doc,t.target.tagName,t.attributeName,a);break;case"childList":t.addedNodes.forEach(function(n){return e.genAdds(n,t.target)}),t.removedNodes.forEach(function(n){var r=e.mirror.getId(n),o=y(t.target)?e.mirror.getId(t.target.host):e.mirror.getId(t.target);X(t.target,e.blockClass)||$(n)||(e.addedSet.has(n)?(ue(e.addedSet,n),e.droppedSet.add(n)):e.addedSet.has(t.target)&&-1===r||Q(t.target,e.mirror)||(e.movedSet.has(n)&&e.movedMap[ie(r,o)]?ue(e.movedSet,n):e.removes.push({parentId:o,id:r,isShadow:!!y(t.target)||void 0})),e.mapRemoves.push(n))})}},this.genAdds=function(t,n){if(!n||!X(n,e.blockClass)){if(ae(t)){if($(t))return;e.movedSet.add(t);var r=null;n&&ae(n)&&(r=n.__sn.id),r&&(e.movedMap[ie(t.__sn.id,r)]=!0)}else e.addedSet.add(t),e.droppedSet.delete(t);X(t,e.blockClass)||t.childNodes.forEach(function(t){return e.genAdds(t)})}}}return e.prototype.init=function(e){var t=this;["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","recordCanvas","inlineImages","slimDOMOptions","doc","mirror","iframeManager","shadowDomManager","canvasManager"].forEach(function(n){t[n]=e[n]})},e.prototype.freeze=function(){this.frozen=!0,this.canvasManager.freeze()},e.prototype.unfreeze=function(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()},e.prototype.isFrozen=function(){return this.frozen},e.prototype.lock=function(){this.locked=!0,this.canvasManager.lock()},e.prototype.unlock=function(){this.locked=!1,this.canvasManager.unlock(),this.emit()},e.prototype.reset=function(){this.shadowDomManager.reset(),this.canvasManager.reset()},e}();function ue(e,t){e.delete(t),t.childNodes.forEach(function(t){return ue(e,t)})}function le(e,t,n){var r=t.parentNode;if(!r)return!1;var o=n.getId(r);return!!e.some(function(e){return e.id===o})||le(e,r,n)}function ce(e,t){var n=t.parentNode;return!!n&&(!!e.has(n)||ce(e,n))}var de=se,fe=[],pe="undefined"!=typeof CSSGroupingRule,ve="undefined"!=typeof CSSMediaRule,me="undefined"!=typeof CSSSupportsRule,he="undefined"!=typeof CSSConditionRule;function ye(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0];return e.target}catch(t){return e.target}}function ge(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t}else if("path"in e&&e.path.length)return e.path;return null}catch(e){return null}}function we(e,t){var n,r,o=new de;fe.push(o),o.init(e);var i=window.MutationObserver||window.__rrMutationObserver,a=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");a&&window[a]&&(i=window[a]);var s=new i(o.processMutations.bind(o));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Se(e){if(!e||!Array.isArray(e))return"";for(var t="",n=e.length>3?3:e.length-1;n>=0;n--)e[n].__sn&&e[n].__sn.tagName&&(t+=n>0?e[n].__sn.tagName+be(e[n].__sn.attributes)+" > ":e[n].__sn.tagName+be(e[n].__sn.attributes));return t}function be(e){var t,n,r="";if(!e)return r;try{for(var o=v(Object.entries(e)),i=o.next();!i.done;i=o.next()){var a=m(i.value,2),s=a[0],u=a[1];"class"==s?r=r+"."+u:"id"==s?r=r+"#"+u:"type"==s&&(r+="[".concat(s,'="').concat(u,'"]'))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}function Ie(e){var t=e.scrollCb,n=e.doc,r=e.mirror,o=e.blockClass;return H("scroll",V(function(e){var i=ye(e);if(i&&!X(i,o)){var a=r.getId(i);if(i===n){var s=n.scrollingElement||n.documentElement;t({id:a,x:s.scrollLeft,y:s.scrollTop})}else t({id:a,x:i.scrollLeft,y:i.scrollTop})}},e.sampling.scroll||100),n)}function Ee(e,t){var n=p({},e);return t||delete n.userTriggered,n}var ke=["INPUT","TEXTAREA","SELECT"],Ce=new WeakMap;function Ne(e){return function(e,t){if(pe&&e.parentRule instanceof CSSGroupingRule||ve&&e.parentRule instanceof CSSMediaRule||me&&e.parentRule instanceof CSSSupportsRule||he&&e.parentRule instanceof CSSConditionRule){var n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else n=Array.from(e.parentStyleSheet.cssRules).indexOf(e),t.unshift(n);return t}(e,[])}for(var Oe=function(){function e(e){this.iframes=new WeakMap,this.mutationCb=e.mutationCb}return e.prototype.addIframe=function(e){this.iframes.set(e,!0)},e.prototype.addLoadListener=function(e){this.loadListener=e},e.prototype.attachIframe=function(e,t){var n;this.mutationCb({adds:[{parentId:e.__sn.id,nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e)},e}(),Re=function(){function e(e){this.restorePatches=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror;var t=this;this.restorePatches.push(Z(HTMLElement.prototype,"attachShadow",function(e){return function(){var n=e.apply(this,arguments);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,this.ownerDocument),n}}))}return e.prototype.addShadowRoot=function(e,t){we(p(p({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e),Ie(p(p({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))},e.prototype.observeAttachShadow=function(e){if(e.contentWindow){var t=this;this.restorePatches.push(Z(e.contentWindow.HTMLElement.prototype,"attachShadow",function(n){return function(){var r=n.apply(this,arguments);return this.shadowRoot&&t.addShadowRoot(this.shadowRoot,e.contentDocument),r}}))}},e.prototype.reset=function(){this.restorePatches.forEach(function(e){return e()})},e}(),Te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xe="undefined"==typeof Uint8Array?[]:new Uint8Array(256),ze=0;ze<Te.length;ze++)xe[Te.charCodeAt(ze)]=ze;var De=new Map,Me=function(e,t,n){if(e&&(Fe(e,t)||"object"==typeof e)){var r=function(e,t){var n=De.get(e);return n||(n=new Map,De.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name),o=r.indexOf(e);return-1===o&&(o=r.length,r.push(e)),o}};function _e(e,t,n){if(e instanceof Array)return e.map(function(e){return _e(e,t,n)});if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){var r=e.constructor.name,o=function(e){var t,n=new Uint8Array(e),r=n.length,o="";for(t=0;t<r;t+=3)o+=Te[n[t]>>2],o+=Te[(3&n[t])<<4|n[t+1]>>4],o+=Te[(15&n[t+1])<<2|n[t+2]>>6],o+=Te[63&n[t+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o}(e);return{rr_type:r,base64:o}}return e instanceof DataView?{rr_type:e.constructor.name,args:[_e(e.buffer,t,n),e.byteOffset,e.byteLength]}:e instanceof HTMLImageElement?{rr_type:e.constructor.name,src:e.src}:e instanceof ImageData?{rr_type:e.constructor.name,args:[_e(e.data,t,n),e.width,e.height]}:Fe(e,t)||"object"==typeof e?{rr_type:e.constructor.name,index:Me(e,t,n)}:e}var Ue=function(e,t,n){return h([],m(e),!1).map(function(e){return _e(e,t,n)})},Fe=function(e,t){var n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(function(e){return"function"==typeof t[e]});return Boolean(n.find(function(n){return e instanceof t[n]}))};function Le(e,t,n,r,o,i){var a,s,u=[],l=Object.getOwnPropertyNames(e),c=function(a){try{if("function"!=typeof e[a])return"continue";var s=Z(e,a,function(s){return function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var c=s.apply(this,u);if(Me(c,i,e),!X(this.canvas,r)){o.getId(this.canvas);var d=Ue(h([],m(u),!1),i,e),f={type:t,property:a,args:d};n(this.canvas,f)}return c}});u.push(s)}catch(r){var l=B(e,a,{set:function(e){n(this.canvas,{type:t,property:a,args:[e],setter:!0})}});u.push(l)}};try{for(var d=v(l),f=d.next();!f.done;f=d.next())c(f.value)}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return u}var Ae,Pe,Ge=function(){function e(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(e,t){!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(e)||this.pendingCanvasMutations.set(e,[]),this.pendingCanvasMutations.get(e).push(t)},this.mutationCb=e.mutationCb,this.mirror=e.mirror,!0===e.recordCanvas&&this.initCanvasMutationObserver(e.win,e.blockClass)}return e.prototype.reset=function(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()},e.prototype.freeze=function(){this.frozen=!0},e.prototype.unfreeze=function(){this.frozen=!1},e.prototype.lock=function(){this.locked=!0},e.prototype.unlock=function(){this.locked=!1},e.prototype.initCanvasMutationObserver=function(e,t){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var n=function(e,t){var n=[];try{var r=Z(e.HTMLCanvasElement.prototype,"getContext",function(e){return function(n){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];return X(this,t)||"__context"in this||(this.__context=n),e.apply(this,h([n],m(r),!1))}});n.push(r)}catch(e){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return function(){n.forEach(function(e){return e()})}}(e,t),r=function(e,t,n,r){var o,i,a=[],s=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype),u=function(r){try{if("function"!=typeof t.CanvasRenderingContext2D.prototype[r])return"continue";var o=Z(t.CanvasRenderingContext2D.prototype,r,function(t){return function(){for(var o=this,i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];return X(this.canvas,n)||setTimeout(function(){var t=h([],m(i),!1);if("drawImage"===r&&t[0]&&t[0]instanceof HTMLCanvasElement){var n=t[0],a=n.getContext("2d"),s=null==a?void 0:a.getImageData(0,0,n.width,n.height);t[0]=JSON.stringify(null==s?void 0:s.data)}e(o.canvas,{type:D["2D"],property:r,args:t})},0),t.apply(this,i)}});a.push(o)}catch(n){var i=B(t.CanvasRenderingContext2D.prototype,r,{set:function(t){e(this.canvas,{type:D["2D"],property:r,args:[t],setter:!0})}});a.push(i)}};try{for(var l=v(s),c=l.next();!c.done;c=l.next())u(c.value)}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}return function(){a.forEach(function(e){return e()})}}(this.processMutation.bind(this),e,t),o=function(e,t,n,r){var o=[];return o.push.apply(o,h([],m(Le(t.WebGLRenderingContext.prototype,D.WebGL,e,n,r,t)),!1)),void 0!==t.WebGL2RenderingContext&&o.push.apply(o,h([],m(Le(t.WebGL2RenderingContext.prototype,D.WebGL2,e,n,r,t)),!1)),function(){o.forEach(function(e){return e()})}}(this.processMutation.bind(this),e,t,this.mirror);this.resetObservers=function(){n(),r(),o()}},e.prototype.startPendingCanvasMutationFlusher=function(){var e=this;requestAnimationFrame(function(){return e.flushPendingCanvasMutations()})},e.prototype.startRAFTimestamping=function(){var e=this,t=function(n){e.rafStamps.latestId=n,requestAnimationFrame(t)};requestAnimationFrame(t)},e.prototype.flushPendingCanvasMutations=function(){var e=this;this.pendingCanvasMutations.forEach(function(t,n){var r=e.mirror.getId(n);e.flushPendingCanvasMutationFor(n,r)}),requestAnimationFrame(function(){return e.flushPendingCanvasMutations()})},e.prototype.flushPendingCanvasMutationFor=function(e,t){if(!this.frozen&&!this.locked){var n=this.pendingCanvasMutations.get(e);if(n&&-1!==t){var r=n.map(function(e){var t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["type"]);return t});this.mutationCb({id:t,type:n[0].type,commands:r}),this.pendingCanvasMutations.delete(e)}}},e}();function We(e){return p(p({},e),{timestamp:Date.now()})}var je={map:{},getId:function(e){return e&&e.__sn?e.__sn.id:-1},getNode:function(e){return this.map[e]||null},removeNodeFromMap:function(e){var t=this;delete this.map[e.__sn&&e.__sn.id],e.childNodes&&e.childNodes.forEach(function(e){return t.removeNodeFromMap(e)})},has:function(e){return this.map.hasOwnProperty(e)},reset:function(){this.map={}}};function He(e){void 0===e&&(e={});var t=e.emit,n=e.checkoutEveryNms,r=e.checkoutEveryNth,o=e.blockClass,i=void 0===o?"rr-block":o,a=e.blockSelector,s=void 0===a?null:a,u=e.ignoreClass,l=void 0===u?"rr-ignore":u,c=e.maskTextClass,d=void 0===c?"rr-mask":c,f=e.maskTextSelector,y=void 0===f?null:f,w=e.inlineStylesheet,S=void 0===w||w,b=e.maskAllInputs,I=e.maskInputOptions,E=e.slimDOMOptions,k=e.maskInputFn,C=e.maskTextFn,N=e.hooks,O=e.packFn,R=e.sampling,D=void 0===R?{}:R,M=e.mousemoveWait,_=e.recordCanvas,U=void 0!==_&&_,F=e.userTriggeredOnInput,L=void 0!==F&&F,A=e.collectFonts,P=void 0!==A&&A,G=e.inlineImages,W=void 0!==G&&G,J=e.plugins,q=e.keepIframeSrcFn,$=void 0===q?function(){return!1}:q;if(!t)throw new Error("emit function is required");void 0!==M&&void 0===D.mousemove&&(D.mousemove=M);var Q,re,oe=!0===b?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==I?I:{password:!0},ie=!0===E||"all"===E?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===E,headMetaDescKeywords:"all"===E}:E||{};void 0===Q&&(Q=window),"NodeList"in Q&&!Q.NodeList.prototype.forEach&&(Q.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in Q&&!Q.DOMTokenList.prototype.forEach&&(Q.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(e){if(!(0 in arguments))throw new TypeError("1 argument is required");do{if(this===e)return!0}while(e=e&&e.parentNode);return!1});var ae=0;Ae=function(e,o){var i;if(!(null===(i=fe[0])||void 0===i?void 0:i.isFrozen())||e.type===T.FullSnapshot||e.type===T.IncrementalSnapshot&&e.data.source===x.Mutation||fe.forEach(function(e){return e.unfreeze()}),t(function(e){var t,n;try{for(var r=v(J||[]),o=r.next();!o.done;o=r.next()){var i=o.value;i.eventProcessor&&(e=i.eventProcessor(e))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return O&&(e=O(e)),e}(e),o),e.type===T.FullSnapshot)re=e,ae=0;else if(e.type===T.IncrementalSnapshot){if(e.data.source===x.Mutation&&e.data.isAttachIframe)return;ae++,(r&&ae>=r||n&&e.timestamp-re.timestamp>n)&&Pe(!0)}};var se=function(e){Ae(We({type:T.IncrementalSnapshot,data:p({source:x.Mutation},e)}))},ue=function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.Scroll},e)}))},le=function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.CanvasMutation},e)}))},ce=new Oe({mutationCb:se}),de=new Ge({recordCanvas:U,mutationCb:le,win:window,blockClass:i,mirror:je}),be=new Re({mutationCb:se,scrollCb:ue,bypassOptions:{blockClass:i,blockSelector:s,maskTextClass:d,maskTextSelector:y,inlineStylesheet:S,maskInputOptions:oe,maskTextFn:C,maskInputFn:k,recordCanvas:U,inlineImages:W,sampling:D,slimDOMOptions:ie,iframeManager:ce,canvasManager:de},mirror:je});Pe=function(e){var t,n,r,o;void 0===e&&(e=!1),Ae(We({type:T.Meta,data:{href:window.location.href,width:Y(),height:K()}}),e),fe.forEach(function(e){return e.lock()});var a=m(function(e,t){var n=t||{},r=n.blockClass,o=n.blockSelector,i=n.maskTextClass,a=n.maskTextSelector,s=n.inlineStylesheet,u=n.inlineImages,l=n.recordCanvas,c=n.maskAllInputs,d=void 0!==c&&c,f=n.slimDOM,p=void 0!==f&&f,v=n.keepIframeSrcFn,m={};return[j(e,{doc:e,map:m,blockClass:void 0===r?"rr-block":r,blockSelector:void 0===o?null:o,maskTextClass:void 0===i?"rr-mask":i,maskTextSelector:void 0===a?null:a,skipChild:!1,inlineStylesheet:void 0===s||s,maskInputOptions:!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===d?{password:!0}:d,maskTextFn:n.maskTextFn,maskInputFn:n.maskInputFn,slimDOMOptions:!0===p||"all"===p?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===p,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===p?{}:p,dataURLOptions:n.dataURLOptions,inlineImages:void 0!==u&&u,recordCanvas:void 0!==l&&l,preserveWhiteSpace:n.preserveWhiteSpace,onSerialize:n.onSerialize,onIframeLoad:n.onIframeLoad,iframeLoadTimeout:n.iframeLoadTimeout,keepIframeSrcFn:void 0===v?function(){return!1}:v}),m]}(document,{blockClass:i,blockSelector:s,maskTextClass:d,maskTextSelector:y,inlineStylesheet:S,maskAllInputs:oe,maskTextFn:C,slimDOM:ie,recordCanvas:U,inlineImages:W,onSerialize:function(e){te(e)&&ce.addIframe(e),ne(e)&&be.addShadowRoot(e.shadowRoot,document)},onIframeLoad:function(e,t){ce.attachIframe(e,t),be.observeAttachShadow(e)},keepIframeSrcFn:$}),2),u=a[0],l=a[1];if(!u)return console.warn("Failed to snapshot the document");je.map=l,Ae(We({type:T.FullSnapshot,data:{node:u,initialOffset:{left:void 0!==window.pageXOffset?window.pageXOffset:(null===document||void 0===document?void 0:document.documentElement.scrollLeft)||(null===(n=null===(t=null===document||void 0===document?void 0:document.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===document||void 0===document?void 0:document.body.scrollLeft)||0,top:void 0!==window.pageYOffset?window.pageYOffset:(null===document||void 0===document?void 0:document.documentElement.scrollTop)||(null===(o=null===(r=null===document||void 0===document?void 0:document.body)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.scrollTop)||(null===document||void 0===document?void 0:document.body.scrollTop)||0}}})),fe.forEach(function(e){return e.unlock()})};try{var Te=[];Te.push(H("DOMContentLoaded",function(){Ae(We({type:T.DomContentLoaded,data:{}}))}));var xe=function(e){var t;return function(e,t){var n,r;void 0===t&&(t={});var o=e.doc.defaultView;if(!o)return function(){};!function(e,t){var n=e.mutationCb,r=e.mousemoveCb,o=e.mouseInteractionCb,i=e.scrollCb,a=e.viewportResizeCb,s=e.inputCb,u=e.mediaInteractionCb,l=e.styleSheetRuleCb,c=e.styleDeclarationCb,d=e.canvasMutationCb,f=e.fontCb;e.mutationCb=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.mutation&&t.mutation.apply(t,h([],m(e),!1)),n.apply(void 0,h([],m(e),!1))},e.mousemoveCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mousemove&&t.mousemove.apply(t,h([],m(e),!1)),r.apply(void 0,h([],m(e),!1))},e.mouseInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mouseInteraction&&t.mouseInteraction.apply(t,h([],m(e),!1)),o.apply(void 0,h([],m(e),!1))},e.scrollCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.scroll&&t.scroll.apply(t,h([],m(e),!1)),i.apply(void 0,h([],m(e),!1))},e.viewportResizeCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.viewportResize&&t.viewportResize.apply(t,h([],m(e),!1)),a.apply(void 0,h([],m(e),!1))},e.inputCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.input&&t.input.apply(t,h([],m(e),!1)),s.apply(void 0,h([],m(e),!1))},e.mediaInteractionCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.mediaInteaction&&t.mediaInteaction.apply(t,h([],m(e),!1)),u.apply(void 0,h([],m(e),!1))},e.styleSheetRuleCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleSheetRule&&t.styleSheetRule.apply(t,h([],m(e),!1)),l.apply(void 0,h([],m(e),!1))},e.styleDeclarationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.styleDeclaration&&t.styleDeclaration.apply(t,h([],m(e),!1)),c.apply(void 0,h([],m(e),!1))},e.canvasMutationCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.canvasMutation&&t.canvasMutation.apply(t,h([],m(e),!1)),d.apply(void 0,h([],m(e),!1))},e.fontCb=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.font&&t.font.apply(t,h([],m(e),!1)),f.apply(void 0,h([],m(e),!1))}}(e,t);var i=we(e,e.doc),a=function(e){var t=e.mousemoveCb,n=e.sampling,r=e.doc,o=e.mirror;if(!1===n.mousemove)return function(){};var i,a="number"==typeof n.mousemove?n.mousemove:50,s=[],u=V(function(e){var n=Date.now()-i;t(s.map(function(e){return e.timeOffset-=n,e}),e),s=[],i=null},"number"==typeof n.mousemoveCallback?n.mousemoveCallback:500),l=V(function(e){var t=ye(e),n=ee(e)?e.changedTouches[0]:e,r=n.clientX,a=n.clientY;i||(i=Date.now()),s.push({x:r,y:a,id:o.getId(t),timeOffset:Date.now()-i}),u("undefined"!=typeof DragEvent&&e instanceof DragEvent?x.Drag:e instanceof MouseEvent?x.MouseMove:x.TouchMove)},a,{trailing:!1}),c=[H("mousemove",l,r),H("touchmove",l,r),H("drag",l,r)];return function(){c.forEach(function(e){return e()})}}(e),s=function(e){var t=e.mouseInteractionCb,n=e.doc,r=e.mirror,o=e.blockClass,i=e.sampling;if(!1===i.mouseInteraction)return function(){};var a=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,s=[];return Object.keys(z).filter(function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==a[e]}).forEach(function(e){var i=e.toLowerCase(),a=function(e){return function(n){var i=ye(n);if(!X(i,o)){var a=ee(n)?n.changedTouches[0]:n;if(a){var s=r.getId(i),u=a.clientX,l=a.clientY,c=ge(n),d=c?Se(c):"";t({type:z[e],id:s,x:u,y:l,nodePath:d})}}}}(e);s.push(H(i,a,n))}),function(){s.forEach(function(e){return e()})}}(e),u=Ie(e),l=function(e){var t=e.viewportResizeCb,n=-1,r=-1;return H("resize",V(function(){var e=K(),o=Y();n===e&&r===o||(t({width:Number(o),height:Number(e)}),n=e,r=o)},200),window)}(e),c=function(e){var t=e.inputCb,n=e.doc,r=e.mirror,o=e.blockClass,i=e.ignoreClass,a=e.maskInputOptions,s=e.maskInputFn,u=e.userTriggeredOnInput;function l(e){var t=ye(e),r=e.isTrusted;if(t&&"OPTION"===t.tagName&&(t=t.parentElement),t&&t.tagName&&!(ke.indexOf(t.tagName)<0)&&!X(t,o)){var l=t.type;if(!t.classList.contains(i)){var d=t.value,f=!1,p=ge(e),v=p?Se(p):"";"radio"===l||"checkbox"===l?f=t.checked:(a[t.tagName.toLowerCase()]||a[l])&&(d=g({maskInputOptions:a,tagName:t.tagName,type:l,value:d,maskInputFn:s})),c(t,Ee({text:d,isChecked:f,nodePath:v,userTriggered:r},u));var m=t.name;"radio"===l&&m&&f&&n.querySelectorAll('input[type="radio"][name="'.concat(m,'"]')).forEach(function(e){e!==t&&c(e,Ee({text:e.value,isChecked:!f,nodePath:"",userTriggered:!1},u))})}}}function c(e,n){var o=Ce.get(e);if(!o||o.text!==n.text||o.isChecked!==n.isChecked){Ce.set(e,n);var i=r.getId(e);t(p(p({},n),{id:i}))}}var d=("last"===e.sampling.input?["change"]:["input","change"]).map(function(e){return H(e,l,n)}),f=Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value"),v=[[HTMLInputElement.prototype,"value"],[HTMLInputElement.prototype,"checked"],[HTMLSelectElement.prototype,"value"],[HTMLTextAreaElement.prototype,"value"],[HTMLSelectElement.prototype,"selectedIndex"],[HTMLOptionElement.prototype,"selected"]];return f&&f.set&&d.push.apply(d,h([],m(v.map(function(e){return B(e[0],e[1],{set:function(){l({target:this})}})})),!1)),function(){d.forEach(function(e){return e()})}}(e),d=function(e){var t=e.mediaInteractionCb,n=e.blockClass,r=e.mirror,o=e.sampling,i=function(e){return V(function(o){var i=ye(o);if(i&&!X(i,n)){var a=i.currentTime,s=i.volume,u=i.muted;t({type:e,id:r.getId(i),currentTime:a,volume:s,muted:u})}},o.media||500)},a=[H("play",i(0)),H("pause",i(1)),H("seeked",i(2)),H("volumechange",i(3))];return function(){a.forEach(function(e){return e()})}}(e),f=function(e,t){var n=e.styleSheetRuleCb,r=e.mirror,o=t.win,i=o.CSSStyleSheet.prototype.insertRule;o.CSSStyleSheet.prototype.insertRule=function(e,t){var o=r.getId(this.ownerNode);return-1!==o&&n({id:o,adds:[{rule:e,index:t}]}),i.apply(this,arguments)};var a=o.CSSStyleSheet.prototype.deleteRule;o.CSSStyleSheet.prototype.deleteRule=function(e){var t=r.getId(this.ownerNode);return-1!==t&&n({id:t,removes:[{index:e}]}),a.apply(this,arguments)};var s={};pe?s.CSSGroupingRule=o.CSSGroupingRule:(ve&&(s.CSSMediaRule=o.CSSMediaRule),he&&(s.CSSConditionRule=o.CSSConditionRule),me&&(s.CSSSupportsRule=o.CSSSupportsRule));var u={};return Object.entries(s).forEach(function(e){var t=m(e,2),o=t[0],i=t[1];u[o]={insertRule:i.prototype.insertRule,deleteRule:i.prototype.deleteRule},i.prototype.insertRule=function(e,t){var i=r.getId(this.parentStyleSheet.ownerNode);return-1!==i&&n({id:i,adds:[{rule:e,index:h(h([],m(Ne(this)),!1),[t||0],!1)}]}),u[o].insertRule.apply(this,arguments)},i.prototype.deleteRule=function(e){var t=r.getId(this.parentStyleSheet.ownerNode);return-1!==t&&n({id:t,removes:[{index:h(h([],m(Ne(this)),!1),[e],!1)}]}),u[o].deleteRule.apply(this,arguments)}}),function(){o.CSSStyleSheet.prototype.insertRule=i,o.CSSStyleSheet.prototype.deleteRule=a,Object.entries(s).forEach(function(e){var t=m(e,2),n=t[0],r=t[1];r.prototype.insertRule=u[n].insertRule,r.prototype.deleteRule=u[n].deleteRule})}}(e,{win:o}),y=function(e,t){var n=e.styleDeclarationCb,r=e.mirror,o=t.win,i=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=function(e,t,o){var a,s,u=r.getId(null===(s=null===(a=this.parentRule)||void 0===a?void 0:a.parentStyleSheet)||void 0===s?void 0:s.ownerNode);return-1!==u&&n({id:u,set:{property:e,value:t,priority:o},index:Ne(this.parentRule)}),i.apply(this,arguments)};var a=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=function(e){var t,o,i=r.getId(null===(o=null===(t=this.parentRule)||void 0===t?void 0:t.parentStyleSheet)||void 0===o?void 0:o.ownerNode);return-1!==i&&n({id:i,remove:{property:e},index:Ne(this.parentRule)}),a.apply(this,arguments)},function(){o.CSSStyleDeclaration.prototype.setProperty=i,o.CSSStyleDeclaration.prototype.removeProperty=a}}(e,{win:o}),w=e.collectFonts?function(e){var t=e.fontCb,n=e.doc,r=n.defaultView;if(!r)return function(){};var o=[],i=new WeakMap,a=r.FontFace;r.FontFace=function(e,t,n){var r=new a(e,t,n);return i.set(r,{family:e,buffer:"string"!=typeof t,descriptors:n,fontSource:"string"==typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};var s=Z(n.fonts,"add",function(e){return function(n){return setTimeout(function(){var e=i.get(n);e&&(t(e),i.delete(n))},0),e.apply(this,[n])}});return o.push(function(){r.FontFace=a}),o.push(s),function(){o.forEach(function(e){return e()})}}(e):function(){},S=[];try{for(var b=v(e.plugins),I=b.next();!I.done;I=b.next()){var E=I.value;S.push(E.observer(E.callback,o,E.options))}}catch(e){n={error:e}}finally{try{I&&!I.done&&(r=b.return)&&r.call(b)}finally{if(n)throw n.error}}return function(){fe.forEach(function(e){return e.reset()}),i.disconnect(),a(),s(),u(),l(),c(),d(),f(),y(),w(),S.forEach(function(e){return e()})}}({mutationCb:se,mousemoveCb:function(e,t){return Ae(We({type:T.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.MouseInteraction},e)}))},scrollCb:ue,viewportResizeCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.ViewportResize},e)}))},inputCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.Input},e)}))},mediaInteractionCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.StyleSheetRule},e)}))},styleDeclarationCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.StyleDeclaration},e)}))},canvasMutationCb:le,fontCb:function(e){return Ae(We({type:T.IncrementalSnapshot,data:p({source:x.Font},e)}))},blockClass:i,ignoreClass:l,maskTextClass:d,maskTextSelector:y,maskInputOptions:oe,inlineStylesheet:S,sampling:D,recordCanvas:U,inlineImages:W,userTriggeredOnInput:L,collectFonts:P,doc:e,maskInputFn:k,maskTextFn:C,blockSelector:s,slimDOMOptions:ie,mirror:je,iframeManager:ce,shadowDomManager:be,canvasManager:de,plugins:(null===(t=null==J?void 0:J.filter(function(e){return e.observer}))||void 0===t?void 0:t.map(function(e){return{observer:e.observer,options:e.options,callback:function(t){return Ae(We({type:T.Plugin,data:{plugin:e.name,payload:t}}))}}}))||[]},N)};ce.addLoadListener(function(e){Te.push(xe(e.contentDocument))});var ze=function(){Pe(),Te.push(xe(document))};return"interactive"===document.readyState||"complete"===document.readyState?ze():Te.push(H("load",function(){Ae(We({type:T.Load,data:{}})),ze()},window)),function(){Te.forEach(function(e){return e()})}}catch(e){console.warn(e)}}He.addCustomEvent=function(e,t){if(!Ae)throw new Error("please add custom event after start recording");Ae(We({type:T.Custom,data:{tag:e,payload:t}}))},He.freezePage=function(){fe.forEach(function(e){return e.freeze()})},He.takeFullSnapshot=function(e){if(!Pe)throw new Error("please take full snapshot after start recording");Pe(e)},He.mirror=je;var Je=Uint8Array,qe=Uint16Array,Ve=Uint32Array,Be=new Je([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ze=new Je([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ke=new Je([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ye=function(e,t){for(var n=new qe(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var o=new Ve(n[30]);for(r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)o[i]=i-n[r]<<5|r;return[n,o]},Xe=Ye(Be,2),$e=Xe[1];Xe[0][28]=258,$e[258]=28;for(var Qe=Ye(Ze,0)[1],et=new qe(32768),tt=0;tt<32768;++tt){var nt=(43690&tt)>>>1|(21845&tt)<<1;et[tt]=((65280&(nt=(61680&(nt=(52428&nt)>>>2|(13107&nt)<<2))>>>4|(3855&nt)<<4))>>>8|(255&nt)<<8)>>>1}var rt=function(e,t,n){for(var r=e.length,o=0,i=new qe(t);o<r;++o)++i[e[o]-1];var a,s=new qe(t);for(o=0;o<t;++o)s[o]=s[o-1]+i[o-1]<<1;if(n){a=new qe(1<<t);var u=15-t;for(o=0;o<r;++o)if(e[o])for(var l=o<<4|e[o],c=t-e[o],d=s[e[o]-1]++<<c,f=d|(1<<c)-1;d<=f;++d)a[et[d]>>>u]=l}else for(a=new qe(r),o=0;o<r;++o)a[o]=et[s[e[o]-1]++]>>>15-e[o];return a},ot=new Je(288);for(tt=0;tt<144;++tt)ot[tt]=8;for(tt=144;tt<256;++tt)ot[tt]=9;for(tt=256;tt<280;++tt)ot[tt]=7;for(tt=280;tt<288;++tt)ot[tt]=8;var it=new Je(32);for(tt=0;tt<32;++tt)it[tt]=5;var at,st=rt(ot,9,0),ut=rt(it,5,0),lt=function(e){return(e/8>>0)+(7&e&&1)},ct=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof qe?qe:e instanceof Ve?Ve:Je)(n-t);return r.set(e.subarray(t,n)),r},dt=function(e,t,n){var r=t/8>>0;e[r]|=n<<=7&t,e[r+1]|=n>>>8},ft=function(e,t,n){var r=t/8>>0;e[r]|=n<<=7&t,e[r+1]|=n>>>8,e[r+2]|=n>>>16},pt=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var o=n.length,i=n.slice();if(!o)return[new Je(0),0];if(1==o){var a=new Je(n[0].s+1);return a[n[0].s]=1,[a,1]}n.sort(function(e,t){return e.f-t.f}),n.push({s:-1,f:25001});var s=n[0],u=n[1],l=0,c=1,d=2;for(n[0]={s:-1,f:s.f+u.f,l:s,r:u};c!=o-1;)s=n[n[l].f<n[d].f?l++:d++],u=n[l!=c&&n[l].f<n[d].f?l++:d++],n[c++]={s:-1,f:s.f+u.f,l:s,r:u};var f=i[0].s;for(r=1;r<o;++r)i[r].s>f&&(f=i[r].s);var p=new qe(f+1),v=vt(n[c-1],p,0);if(v>t){r=0;var m=0,h=v-t,y=1<<h;for(i.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});r<o;++r){var g=i[r].s;if(!(p[g]>t))break;m+=y-(1<<v-p[g]),p[g]=t}for(m>>>=h;m>0;){var w=i[r].s;p[w]<t?m-=1<<t-p[w]++-1:++r}for(;r>=0&&m;--r){var S=i[r].s;p[S]==t&&(--p[S],++m)}v=t}return[new Je(p),v]},vt=function(e,t,n){return-1==e.s?Math.max(vt(e.l,t,n+1),vt(e.r,t,n+1)):t[e.s]=n},mt=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new qe(++t),r=0,o=e[0],i=1,a=function(e){n[r++]=e},s=1;s<=t;++s)if(e[s]==o&&s!=t)++i;else{if(!o&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(o),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(o);i=1,o=e[s]}return[n.subarray(0,r),t]},ht=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},yt=function(e,t,n){var r=n.length,o=lt(t+2);e[o]=255&r,e[o+1]=r>>>8,e[o+2]=255^e[o],e[o+3]=255^e[o+1];for(var i=0;i<r;++i)e[o+i+4]=n[i];return 8*(o+4+r)},gt=function(e,t,n,r,o,i,a,s,u,l,c){dt(t,c++,n),++o[256];for(var d=pt(o,15),f=d[0],p=d[1],v=pt(i,15),m=v[0],h=v[1],y=mt(f),g=y[0],w=y[1],S=mt(m),b=S[0],I=S[1],E=new qe(19),k=0;k<g.length;++k)E[31&g[k]]++;for(k=0;k<b.length;++k)E[31&b[k]]++;for(var C=pt(E,7),N=C[0],O=C[1],R=19;R>4&&!N[Ke[R-1]];--R);var T,x,z,D,M=l+5<<3,_=ht(o,ot)+ht(i,it)+a,U=ht(o,f)+ht(i,m)+a+14+3*R+ht(E,N)+(2*E[16]+3*E[17]+7*E[18]);if(M<=_&&M<=U)return yt(t,c,e.subarray(u,u+l));if(dt(t,c,1+(U<_)),c+=2,U<_){T=rt(f,p,0),x=f,z=rt(m,h,0),D=m;var F=rt(N,O,0);for(dt(t,c,w-257),dt(t,c+5,I-1),dt(t,c+10,R-4),c+=14,k=0;k<R;++k)dt(t,c+3*k,N[Ke[k]]);c+=3*R;for(var L=[g,b],A=0;A<2;++A){var P=L[A];for(k=0;k<P.length;++k)dt(t,c,F[G=31&P[k]]),c+=N[G],G>15&&(dt(t,c,P[k]>>>5&127),c+=P[k]>>>12)}}else T=st,x=ot,z=ut,D=it;for(k=0;k<s;++k)if(r[k]>255){var G;ft(t,c,T[257+(G=r[k]>>>18&31)]),c+=x[G+257],G>7&&(dt(t,c,r[k]>>>23&31),c+=Be[G]);var W=31&r[k];ft(t,c,z[W]),c+=D[W],W>3&&(ft(t,c,r[k]>>>5&8191),c+=Ze[W])}else ft(t,c,T[r[k]]),c+=x[r[k]];return ft(t,c,T[256]),c+x[256]},wt=new Ve([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),St=function(e){var t=p(p({},e),{v:"v1"});return function(e,t){for(var n="",r=0;r<e.length;){var o=e[r++];n+=String.fromCharCode(o)}return n}(function(e,t){void 0===t&&(t={});var n=function(){var e=1,t=0;return{p:function(n){for(var r=e,o=t,i=n.length,a=0;a!=i;){for(var s=Math.min(a+5552,i);a<s;++a)o+=r+=n[a];r%=65521,o%=65521}e=r,t=o},d:function(){return(e>>>8<<16|(255&t)<<8|t>>>8)+2*((255&e)<<23)}}}();n.p(e);var r,o,i,a,s,u=function(e,t,n,r,o,i){var a=e.length,s=new Je(2+a+5*(1+Math.floor(a/7e3))+4),u=s.subarray(2,s.length-4),l=0;if(!t||a<8)for(var c=0;c<=a;c+=65535){var d=c+65535;d<a?l=yt(u,l,e.subarray(c,d)):(u[c]=!0,l=yt(u,l,e.subarray(c,a)))}else{for(var f=wt[t-1],p=f>>>13,v=8191&f,m=(1<<n)-1,h=new qe(32768),y=new qe(m+1),g=Math.ceil(n/3),w=2*g,S=function(t){return(e[t]^e[t+1]<<g^e[t+2]<<w)&m},b=new Ve(25e3),I=new qe(288),E=new qe(32),k=0,C=0,N=(c=0,0),O=0,R=0;c<a;++c){var T=S(c),x=32767&c,z=y[T];if(h[x]=z,y[T]=x,O<=c){var D=a-c;if((k>7e3||N>24576)&&D>423){l=gt(e,u,0,b,I,E,C,N,R,c-R,l),N=k=C=0,R=c;for(var M=0;M<286;++M)I[M]=0;for(M=0;M<30;++M)E[M]=0}var _=2,U=0,F=v,L=x-z&32767;if(D>2&&T==S(c-L))for(var A=Math.min(p,D)-1,P=Math.min(32767,c),G=Math.min(258,D);L<=P&&--F&&x!=z;){if(e[c+_]==e[c+_-L]){for(var W=0;W<G&&e[c+W]==e[c+W-L];++W);if(W>_){if(_=W,U=L,W>A)break;var j=Math.min(L,W-2),H=0;for(M=0;M<j;++M){var J=c-L+M+32768&32767,q=J-h[J]+32768&32767;q>H&&(H=q,z=J)}}}L+=(x=z)-(z=h[x])+32768&32767}if(U){b[N++]=268435456|$e[_]<<18|Qe[U];var V=31&$e[_],B=31&Qe[U];C+=Be[V]+Ze[B],++I[257+V],++E[B],O=c+_,++k}else b[N++]=e[c],++I[e[c]]}}l=gt(e,u,!0,b,I,E,C,N,R,c-R,l)}return ct(s,0,2+lt(l)+4)}(r=e,null==(o=t).level?6:o.level,null==o.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(r.length)))):12+o.mem);return s=0==(a=t.level)?0:a<6?1:9==a?3:2,(i=u)[0]=120,i[1]=s<<6|(s?32-2*s:1),function(e,t,n){for(;n;++t)e[t]=n,n>>>=8}(u,u.length-4,n.d()),u}(function(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var r=new Je(e.length+(e.length>>>1)),o=0,i=function(e){r[o++]=e},a=0;a<n;++a){if(o+5>r.length){var s=new Je(o+8+(n-a<<1));s.set(r),r=s}var u=e.charCodeAt(a);u<128?i(u):u<2048?(i(192|u>>>6),i(128|63&u)):u>55295&&u<57344?(i(240|(u=65536+(1047552&u)|1023&e.charCodeAt(++a))>>>18),i(128|u>>>12&63),i(128|u>>>6&63),i(128|63&u)):(i(224|u>>>12),i(128|u>>>6&63),i(128|63&u))}return ct(r,0,o)}(JSON.stringify(t))))};function bt(){return bt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bt.apply(this,arguments)}function It(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Et(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return It(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?It(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var kt=new Uint8Array(16);function Ct(){if(!at&&!(at="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return at(kt)}var Nt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ot(e){return"string"==typeof e&&Nt.test(e)}for(var Rt=[],Tt=0;Tt<256;++Tt)Rt.push((Tt+256).toString(16).substr(1));function xt(e,t,n){var r=(e=e||{}).random||(e.rng||Ct)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Rt[e[t+0]]+Rt[e[t+1]]+Rt[e[t+2]]+Rt[e[t+3]]+"-"+Rt[e[t+4]]+Rt[e[t+5]]+"-"+Rt[e[t+6]]+Rt[e[t+7]]+"-"+Rt[e[t+8]]+Rt[e[t+9]]+"-"+Rt[e[t+10]]+Rt[e[t+11]]+Rt[e[t+12]]+Rt[e[t+13]]+Rt[e[t+14]]+Rt[e[t+15]]).toLowerCase();if(!Ot(n))throw TypeError("Stringified UUID is invalid");return n}(r)}function zt(){return Date.now()}function Dt(e,t,n){var r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}function Mt(){var e=Math.floor(Date.now()/1e3);return xt()+"-"+e}function _t(e){var t={externalId:"enduser_external_id",firstName:"eu_first_name",lastName:"eu_last_name",email:"eu_email",age:"eu_age",customerName:"eu_customer_name",avatar:"eu_avatar",phone:"eu_phone"};return e in t?t[e]:e}var Ut={domCapture:!0,consoleCapture:!0,networkCapture:!0,stackTraceCapture:!0,webSocketsCapture:!1,ipCapture:!0,inputMasking:!1,textMasking:!0,paid:!1,apiKey:"",streamUrl:"https://qacollector.zipy.ai",maxBufferSize:5e6,compression:!0,compressionType:"gzip",timeFrequency:1e3,encodingType:"",sessionTimeout:18e5,failureRetryCount:5,bufferSizeFrequency:1048576,ignoreUrl:["google.com","zipy.ai","mixpanel","extreme-ip-lookup.com","hotjar","smartlook.com","newrelic.com","bugsnag","fullstory","sentry.io","google-analytics.com","bam.nr-data.net","wistia.com","amplitude.com","segment.io","pendo.io","raygun","smartlook.cloud","segment.com","visualstudio.com","stats.g.doubleclick.net","pagead2.googlesyndication.com","r.lr-in.com"],ignoreError:["rrweb","zipy","Script error","pagead2.googlesyndication.com","adsbygoogle"],ignoreConsole:["{}"],isIgnoreUrlError:["google.com","zipy.ai","mixpanel","extreme-ip-lookup.com","hotjar","smartlook.com","newrelic.com","bugsnag","fullstory","sentry.io","google-analytics.com","bam.nr-data.net","wistia.com","amplitude.com","segment.io","pendo.io","raygun","smartlook.cloud","segment.com","visualstudio.com","stats.g.doubleclick.net","pagead2.googlesyndication.com","r.lr-in.com"],isIgnoreConsoleError:["{}"],ip:"",pack:!1,blockClasses:"zipy-block"};function Ft(e){return bt({},e,{timestamp:zt()})}function Lt(){return window.sdkConfig?window.sdkConfig:Ut}var At,Pt=function(e,t,n){return e&&e.constructor===String&&n.indexOf(e)===t},Gt=function(e){return e&&e.constructor===String&&e.trim()};function Wt(e){var t=Ht();return t.length>0?(t.forEach(function(t){return delete e[t]}),e):e}function jt(e){var t=Ht();return t.length>0&&t.indexOf(e)>-1}function Ht(){return Lt().headersToSanitize?Lt().headersToSanitize.split(","):[]}function Jt(e,n){if(e&&null!=e)try{var r="";r="string"!=typeof e?JSON.stringify(e):e;for(var o=t.RangeError;o<=t.EvalError;o++)if(-1!=r.search(t[o]))return o}catch(e){d(e)}return n}function qt(e){if(null==e)return!1;var t=e.toLowerCase(),n=Lt().ignoreError;try{if(n.some(function(e){return t.includes(e.toLowerCase())}))return l("Ignoring error for data: "+e),!0}catch(e){d(e)}return!1}function Vt(e){if("online"!=(navigator.onLine?"online":"offline")){if(!window.iszInternetDisconnected)return window.iszInternetDisconnected=!0,l("handleConnectionChange :: send internet disconnected"),e(Ft({eventType:t.Offline,data:{status:"Offline",type:""},isError:!1}))}else var n=setInterval(function(){fetch("//google.com",{mode:"no-cors"}).then(function(){return window.iszInternetDisconnected&&(window.iszInternetDisconnected=!1,l("handleConnectionChange :: send internet connected"),e(Ft({eventType:t.Online,data:{status:"Online",type:""},isError:!1}))),clearInterval(n)}).catch(function(){window.iszInternetDisconnected||(window.iszInternetDisconnected=!0,l("handleConnectionChange :: send internet disconnected"),e(Ft({eventType:t.Offline,data:{status:"Offline",type:""},isError:!1})))})},5e3)}var Bt=new Map;function Zt(e){try{var t=window.localStorage.getItem(e);return!t&&(u("fetched value from hashmap :"+(t=Bt.get(e))),t)?(u("Going to update local storage:"),function(){try{u("inside localStorageUpdate function");for(var e,t=Et(Bt.entries());!(e=t()).done;){var n=e.value;Kt(n[0],n[1])}}catch(e){d("inside updateLocalStorage catch block ${e.message}")}}(),t):t}catch(e){return void d("inside zLocalStorageGetItem catch block ${e.message}")}}function Kt(e,t){try{u("inside zLocalStorageSetItem for key :"+e+" and value :"+t),Bt.set(e,t),window.localStorage.setItem(e,t)}catch(e){d("inside zLocalStorageSetItem catch block ${e.message}")}}function Yt(e){try{u("inside zLocalStorageRemoveItem for key :"+e),Bt.delete(e),window.localStorage.removeItem(e)}catch(e){d("inside zLocalStorageSetItem catch block ${e.message}")}}function Xt(){var e=Zt("zsdk-config");if(e)try{return JSON.parse(e)}catch(e){return void d("Failed to parse sdk Config Data")}}function $t(e){var t={isBlocked:!1,blockedEndTime:0,apiKey:e};try{window.zSessionBlockedInfo=t,u("Updating zsession-blocked-info"+JSON.stringify(t)),Kt("zsession-blocked-info",JSON.stringify(t))}catch(e){d("Failed to stringify zsession-blocked-info ")}}function Qt(){var e=Zt("zsession-blocked-info");if(e)try{var t=JSON.parse(e);return window.zSessionBlockedInfo=t,t}catch(e){return void d("Failed to parse zsession-blocked-info")}}function en(){var e=Zt("session-data");if(e)try{return JSON.parse(e)}catch(e){return void d("Failed to parse session data")}}function tn(e){if(window.iszSessionExpired)return l("Session is already expired"),!0;var t=(en()||{}).sessionId,n=Number(Zt("last-activity-time"));return(!t||n+e.sessionTimeout<=Date.now())&&(u("Session is expired"),window.iszSessionExpired=!0,!0)}function nn(){var e=Zt("pack");if(!e){var t=Lt();Kt("pack",e=t.pack?t.pack.toString():(!1).toString())}return"true"===e}function rn(e){var t=Zt("zId");t||Kt("zId",t=Mt());var n=Mt(),r="0:"+Mt().replace("-",":");!function(e){Yt("pack"),$t(e)}(e),Yt("pack");var o={sessionId:n,dSession:r,isNewSession:!0,sdkKey:e,isActive:!1};try{u("Created new Session"+JSON.stringify(o)),Kt("session-data",JSON.stringify(o)),Kt("last-activity-time",Date.now().toString()),window.iszSessionExpired=!1}catch(e){d("Failed to stringify  session data")}}function on(e){var t=en();return!!t&&e!==(null==t?void 0:t.sdkKey)&&(u("Sdk key is chnaged going to create session data"),!0)}function an(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var sn=function e(t,n,r,o,i){void 0===n&&(n=5),void 0===i&&(i={});try{return Promise.resolve(an(function(){var a=new URL(t);return null!=r&&Object.keys(r).forEach(function(e){return a.searchParams.append(e,r[e])}),Promise.resolve(fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).then(function(a){return a.ok?(c("postDataOnServer :: Response status = "+a.status),Promise.resolve(a.json()).then(function(e){return c("postDataOnServer :: Response JSON = "+e),e})):(c("Error :: Response status = "+a.status),n>0?e(t,n-1,r,o,i):(d("Not able to post enduser config after all retriues"),!1))})},function(e){return d("Not able to get response from server with ERROR: "+e),!1}))}catch(e){return Promise.reject(e)}},un=function e(t){var n=t.divolteUrl,r=t.divolteJson,o=t.failureRetryCount;try{return Promise.resolve(an(function(){return Promise.resolve(fetch(n,{method:"POST",headers:{"Content-Type":"application/json","Content-Encoding":"gzip"},body:JSON.stringify(r)})).then(function(t){return t.ok?(c("Response status = "+t.status),!0):(c("Error :: Response status = "+t.status),o>0?e({divolteUrl:n,divolteJson:r,failureRetryCount:o-1}):(d("Not able to send data after all retries"),!1))})},function(e){return d("Not able to get response from server with ERROR: "+e),!1}))}catch(e){return Promise.reject(e)}};function ln(){var e=Zt("zId");return e||(Kt("zId",e=Mt()),e)}function cn(){var e=Zt("zenduser-info");if(e)try{return JSON.parse(e)}catch(e){return void d("Failed to parse end user Info data")}}function dn(){var e=Zt("zenduser-info-temp");if(e)try{return JSON.parse(e)}catch(e){return void d("Failed to parse end user Info data")}}function fn(e){ln(),cn()||u("Creating new enduser-info"+JSON.stringify(e));try{u("Updating enduser-info"+JSON.stringify(e)),Kt("zenduser-info",JSON.stringify(e))}catch(e){d("Failed to stringify  enduser-info ")}}function pn(e){ln(),cn()||u("Creating new enduser-info-temp"+JSON.stringify(e));try{u("Updating enduser-info-temp"+JSON.stringify(e)),Kt("zenduser-info-temp",JSON.stringify(e))}catch(e){d("Failed to stringify  enduser-info-temp ")}}function vn(){dn()?(u("Removing zenduser-info-temp"),Yt("zenduser-info-temp")):u("zenduser temp Data dosen't exists")}function mn(e,t){e.euId=0,e.euZName="",e.isBlocked=!1,e.zAnonymsUserInfo={euId:0,euZName:"",zId:null!=t?t:""}}function hn(e,t){var n,r,o=ln();(null==e||null==(n=e.zAnonymsUserInfo)?void 0:n.zId)===o?(u("ZId match"),e.euId=e.zAnonymsUserInfo.euId,e.euZName=e.zAnonymsUserInfo.euZName):(u("ZId dosen't match Zid : "+o+" and Anonyms user Zid: "+(null==e||null==(r=e.zAnonymsUserInfo)?void 0:r.zId)),mn(e,o)),t?pn(e):fn(e)}function yn(){if(dn())return u("Temp storage has some pending data to post"),!0;var e=cn();if(!e)return u("zenduser Data dosen't exists"),!0;if(0===e.euId)return u("Euid value is 0, required to fetch data again"),!0;if(e.userType===r.ANONYMS){var t,n;if(null==e||null==(t=e.zExternalUserInfo)?void 0:t.externalId)return u("External User details exists, and userType is ANONYMS need to post data"),!0;var o=ln();if((null==(n=e.zAnonymsUserInfo)?void 0:n.zId)!==o)return u("ZId dosen't match Zid : "+o+" and Anonyms user Zid: "+e.zAnonymsUserInfo.zId),mn(e,o),fn(e),!0;u("ZId match No need to update for anonyms user")}return!1}var gn=function(e,t,o){void 0===t&&(t=0);try{var i={v:a.sdkVersion,e:"Production",o:t,ns:o};if(t==n.POSTENDUSERINFOANDGETUSERCONFIG||t==n.GETUSERCONFIG){var s=Xt();window.sdkConfig=s||Ut}var c=Qt();if(c&&c.isBlocked)return u("Not going to call post end user info as session is already blocked"),Promise.resolve(window.sdkConfig);window.iszHandshakeDone=!1,window.zpendingOp=t,l("config.sdkversion"+a.sdkVersion);var f=dn()||{zAnonymsUserInfo:{}},p={},v=r.ANONYMS;if(f){var m,h=f.zExternalUserInfo||{};for(var y in h)p[_t(y)]=h[y]?h[y]:"";p.enduser_zipy_id=null==(m=f.zAnonymsUserInfo)?void 0:m.zId,h.externalId&&(u("Get User info for user Type Identified "+h.externalId),v=r.IDENTIFIED)}return window.ztryForHandshake=!1,Promise.resolve(sn(a.streamMgrUrl+"/"+e,a.streamMgrRetryCount,i,p)).then(function(o){if(o)if((null==o?void 0:o.api_key)==e){var i=Qt(),s=en()||{},l=!(null==o||!o.is_blocked)&&(null==o?void 0:o.is_blocked);if(i&&(i.isBlocked||s.isActive||En(o,e)),l)return window.sdkConfig;if(t==n.POSTENDUSERINFOANDGETUSERCONFIG||t==n.GETUSERCONFIG){var c=function(e){var t,n={domCapture:null!=e&&e.dom_capture?null==e?void 0:e.dom_capture:Ut.domCapture,consoleCapture:null!=e&&e.console_capture?null==e?void 0:e.console_capture:Ut.consoleCapture,networkCapture:null!=e&&e.network_capture?null==e?void 0:e.network_capture:Ut.networkCapture,stackTraceCapture:null!=e&&e.stack_trace_capture?null==e?void 0:e.stack_trace_capture:Ut.stackTraceCapture,webSocketsCapture:null!=e&&e.web_sockets_capture?null==e?void 0:e.web_sockets_capture:Ut.webSocketsCapture,ipCapture:null!=e&&e.ip_capture?null==e?void 0:e.ip_capture:Ut.ipCapture,inputMasking:null!=e&&e.input_masking?null==e?void 0:e.input_masking:Ut.inputMasking,textMasking:null!=e&&e.text_masking?null==e?void 0:e.text_masking:Ut.textMasking,paid:null!=e&&e.paid?null==e?void 0:e.paid:Ut.paid,apiKey:null==e?void 0:e.api_key,streamUrl:null!=e&&e.stream_url?null==e?void 0:e.stream_url:Ut.streamUrl,maxBufferSize:null!=e&&e.max_buffer_size?1024*(null==e?void 0:e.max_buffer_size):Ut.maxBufferSize,compression:null!=e&&e.compression?null==e?void 0:e.compression:Ut.compression,compressionType:null!=e&&e.compression_type?null==e?void 0:e.compression_type:Ut.compressionType,timeFrequency:null!=e&&e.time_frequency?1e3*(null==e?void 0:e.time_frequency):Ut.timeFrequency,encodingType:null==e?void 0:e.encoding_type,sessionTimeout:null!=e&&e.session_timeout?1e3*(null==e?void 0:e.session_timeout):Ut.sessionTimeout,failureRetryCount:null!=e&&e.failure_retry_count?null==e?void 0:e.failure_retry_count:Ut.failureRetryCount,bufferSizeFrequency:null!=e&&e.buffer_size_frequency?1024*(null==e?void 0:e.buffer_size_frequency):Ut.bufferSizeFrequency,ignoreUrl:null!=e&&e.ignoreUrl?null==e?void 0:e.ignoreUrl:Ut.ignoreUrl,ignoreError:null!=e&&e.ignoreError?null==e?void 0:e.ignoreError:Ut.ignoreError,ignoreConsole:null!=e&&e.ignoreConsole?null==e?void 0:e.ignoreConsole:Ut.ignoreConsole,isIgnoreUrlError:null!=e&&e.isIgnoreUrlError?null==e?void 0:e.isIgnoreUrlError:Ut.isIgnoreUrlError,isIgnoreConsoleError:null!=e&&e.isIgnoreConsoleError?null==e?void 0:e.isIgnoreConsoleError:Ut.isIgnoreConsoleError,ip:null!=e&&e.ip?null==e?void 0:e.ip:"",pack:!(null==e||!e.pack||!e.pack),blockClasses:(t=null!=e&&e.blockClasses?null==e?void 0:e.blockClasses:Ut.blockClasses,t=(t=t&&t.length?t+",zipy-block":"zipy-block").split(",").filter(Pt).map(Gt).join("|"),new RegExp(t)),customerId:null==e?void 0:e.cId,headersToSanitize:null!=e&&e.headersToSanitize?e.headersToSanitize:""};return n.ignoreUrl.push(n.streamUrl.substring(n.streamUrl.indexOf("://")+3)),n.ignoreUrl.push(a.streamMgrUrl.substring(a.streamMgrUrl.indexOf("://")+3)),n.ignoreUrl.push("google.com"),n.isIgnoreUrlError.push(n.streamUrl.substring(n.streamUrl.indexOf("://")+3)),n.isIgnoreUrlError.push(a.streamMgrUrl.substring(a.streamMgrUrl.indexOf("://")+3)),n.isIgnoreUrlError.push("google.com"),function(e){if(e)try{u("Updating zsdk-config"+JSON.stringify(e)),Kt("zsdk-config",JSON.stringify(e))}catch(e){d("Failed to stringify zsdk-config ")}}(n),n}(o);window.iszHandshakeDone=!0,u("sdkConfigResp"+JSON.stringify(c)),c&&(window.sdkConfig=c)}if(t==n.POSTENDUSERINFOANDGETUSERCONFIG||t==n.POSTENDUSERINFO){var p=o.enduser_info||{};u("Response object received for End User from stream manager: "+JSON.stringify(p)),p&&(u("Going to add enduser info after data parsing"),f.userType=v,f.euId=p.id?p.id:0,f.euZName=p.zipy_eu_name?p.zipy_eu_name:"",f.isBlocked=!!p.is_blocked&&p.is_blocked,v==r.ANONYMS&&(f.zAnonymsUserInfo.euId=f.euId,f.zAnonymsUserInfo.euZName=f.euZName,f.zExternalUserInfo={}),fn(f),vn())}}else d("Not able to get response from stream manager for sdk Key: "+e);else d("Not able to get response from stream manager ");return window.sdkConfig})}catch(e){return Promise.reject(e)}},wn=function(e){try{var t,n=Lt(),r=window.zEventsData||[];l("Data Length for direct streaming ");var o="";try{l("Data Length "+(o=JSON.stringify(r)).length)}catch(e){d("Failed to stringify zEvents")}var i=r.length,s=function(){if(2*o.length>=n.bufferSizeFrequency||window.lastSyncTime+n.timeFrequency<=Date.now()&&i>0){var s,l,c=r.slice(0,i),f=en()||{},p=cn()||{},v=Zt("zId"),m=null!=(s=p.zExternalUserInfo)&&s.externalId?null==(l=p.zExternalUserInfo)?void 0:l.externalId:"",h=/\((.*)\)/.exec((new Date).toString())[1],y=nn(),g={key:e,sdk_ver:a.sdkVersion,src:"Frontend",s_id:f.sessionId,euz_id:v,eue_id:m,events:c,eu_info_id:p.euId,rel_ver:window.zRelVer,handshake_status:window.iszHandshakeDone,ip:n.ip,deviceName:"",screenWidth:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,screenHeight:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,userAgent:window.navigator.userAgent,timeZone:h,pack:y},w="";try{w=JSON.stringify(g)}catch(e){d("Failed to stringify zipyDataJson")}var S={eventData:w};return Promise.resolve(function(e){try{var t=function(){if("isActive"in(t=en()||{})&&!t.isActive)return u("Going to register new session"),Promise.resolve(function(e){try{var t={v:a.sdkVersion},n=en(),r={enduser_session_id:n.sessionId,user_agent:window.navigator.userAgent,ip_address:"",location:"",enduser_zipy_id:"",project_release_version:"",sdk_version:"",device_name:"",screen_width:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,screen_height:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth};return Promise.resolve(sn(a.registerSessionUrl+"/"+e,a.streamMgrRetryCount,t,r)).then(function(t){return t?(function(){var e=en();if(!e)return!1;try{u("Setting session as active"+JSON.stringify(e)),e.isActive=!0,Kt("session-data",JSON.stringify(e))}catch(e){return d("Failed to stringify  session data"),!1}}(),En(t,e),!0):(d("Not able to register new session for session Id : "+n.sessionId),!1)})}catch(e){return Promise.reject(e)}}(e)).then(function(){});var t}();return Promise.resolve(t&&t.then?t.then(function(){}):void 0)}catch(e){return Promise.reject(e)}}(e)).then(function(){if(kn())return function(){for(;window.zEventsData.length;)window.zEventsData.pop();window.zEventsData=[]}(),t=!0;var e={session_id:f.dSession,event_id:"AruZ~Em0WNlAnbyzVmwM~GR0cMb6Xl9r",is_new_party:f.isNewSession,is_new_session:f.isNewSession,client_timestamp_iso:(new Date).toISOString(),event_type:"MyEventRecord",parameters:S},r=n.streamUrl+"?p="+f.dSession;return window.isDataSyncInProgress=!0,Promise.resolve(un({divolteUrl:r,divolteJson:e,failureRetryCount:n.failureRetryCount})).then(function(e){if(e){if(window.lastSyncTime=Date.now(),function(e){window.zEventsData&&Array.isArray(window.zEventsData)?window.zEventsData.splice(0,e):window.zEventsData=[]}(i),window.isDataSyncInProgress=!1,Kt("last-activity-time",window.zlastActivityTime),f.isNewSession){var n=en();if(n){n.isNewSession=!1;try{Kt("session-data",JSON.stringify(n))}catch(e){d("Failed to set session-data in localstorage")}}}return t=!0}return Kt("last-activity-time",window.zlastActivityTime),window.isDataSyncInProgress=!1,t=1,!1})})}}();return Promise.resolve(s&&s.then?s.then(function(e){return!t||e}):!t||s)}catch(e){return Promise.reject(e)}};function Sn(e,n){l("Going to init rrweb Recorder"),window.zrrwebRecorderStatus=o.RECORDINGPENDING;var r=function(){};try{r=He({emit:function(e){var n=-1;e.type!=T.IncrementalSnapshot?n=t.ReplayerEvent:((n=e.data.source?e.data.source:t.ReplayerEvent)==t.MouseInteraction||n>=t.ViewportResize&&n<=t.MediaInteraction)&&(window.zrrwebRecorderStatus=o.RECORDINGSUCCESSFUL);try{var r=!1;window.reinitializationInProgress||(r=nn()),In({data:r?St(e):JSON.stringify(e),time:e.timestamp,type:n,isError:!1,navigatedUrl:window.location.origin+window.location.pathname})}catch(e){d("Failed to store rrweb recorder events")}},blockClass:Lt().blockClasses,ignoreClass:"zipy-ignore",maskInputOptions:{password:!0,email:!1},sampling:{mousemove:150,scroll:150,mouseInteraction:{MouseUp:!0,MouseDown:!0,Click:!0,ContextMenu:!1,DblClick:!0,Focus:!1,Blur:!1,TouchStart:!0,TouchEnd:!0}}})}catch(e){d(e)}return r}function bn(e){return l("Going to init zipy Recorder"),function(e){void 0===e&&(e={});var n=e.emit;if(!n)return d("emit function is required to record data from zipy-event-recorder"),function(){};At=function(e){n(e)};try{var r=[];r.push(function(e){var n=location.href,r={navigatedUrl:window.location.href};e(Ft({eventType:t.NAVIGATION,data:r,isError:!1}));var o=window.history.pushState,i=window.history.replaceState;function a(){try{var r={navigatedUrl:window.location.href};n!=r.navigatedUrl&&(e(Ft({eventType:t.NAVIGATION,data:r,isError:!1})),n=r.navigatedUrl)}catch(e){d("not able to capture the navigation url")}}return window.history.pushState=function(){o.apply(window.history,arguments),window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("locationchange"))},window.history.replaceState=function(){i.apply(window.history,arguments),window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("locationchange"))},window.addEventListener("locationchange",a,!1),function(){history.pushState=o,history.replaceState=i,window.removeEventListener("locationchange",a)}}(At));var o=Lt();return u("In zipy-event-record "+JSON.stringify(o)),o.consoleCapture&&r.push(function(e){function n(e){var t="";if("string"!=typeof e)try{t=JSON.stringify(e)}catch(e){}else t=e;try{if(-1!=t.search(i)||-1!=t.search("rrweb"))return!0}catch(e){return!0}return!1}function r(n,r){var o;o="string"==typeof r[0]?r[0]:JSON.stringify(r[0]);var i=n==t.ConsoleError;(function(e,t){if(null==e)return!1;var n,r=e.toLowerCase(),o=Lt();try{n=t?o.isIgnoreConsoleError:o.ignoreConsole}catch(e){d(e)}try{if(n.some(function(e){return r.includes(e.toLowerCase())}))return!0}catch(e){return!1}return!1})(o,i)||e(Ft({eventType:n,data:{arguments:r},isError:i}))}var o=console.error.bind(console);console.error=function(){n(arguments[0])||r(t.ConsoleError,arguments),o.apply(console,arguments)};var a=console.log.bind(console);console.log=function(){n(arguments[0])||r(t.ConsoleInfo,arguments),a.apply(console,arguments)};var s=console.warn.bind(console);console.warn=function(){n(arguments[0])||r(t.ConsoleWarning,arguments),s.apply(console,arguments)};var u=console.debug.bind(console);return console.debug=function(){n(arguments[0])||r(t.ConsoleDebug,arguments),u.apply(console,arguments)},function(){console.error=o,console.log=a,console.warn=s,console.debug=u}}(At)),o.stackTraceCapture&&r.push(function(e){var n=[Dt("error",function(n){!function(e,n){var r=e.message,o=e.filename,i=e.lineno,s=e.colno;if(qt(r)||qt(o))l("Ignoring error from error callback "+r);else if(e.error){var u,c,f;if(qt(null==(u=e.error)?void 0:u.stack))return void l("Ignoring error from error callback "+(null==(f=e.error)?void 0:f.stack));var p,v=null==(c=e.error)?void 0:c.stack;try{p="string"!=typeof v?JSON.stringify(v):v}catch(e){d("Failed to stringfy errorMsg inside error callback with exception"+e)}var m={message:r,filename:o,lineno:i,colno:s,error:p};n(Ft({eventType:Jt(r,t.Error),data:m,isError:!0}))}else{if((null==r||""==r)&&a.ignoreEmptyErros)return void l("Ignored empty error");var h={message:r,filename:o,lineno:i,colno:s,error:""};n(Ft({eventType:Jt(r,t.Error),data:h,isError:!0}))}}(n,e)},window)];return n.push(Dt("unhandledrejection",function(n){var r,o="reason"in n?null==n?void 0:n.reason:n,i=null!=n&&n.reason.stack?n.reason.stack:n;try{r="string"!=typeof i?JSON.stringify(i):i}catch(n){d("Failed to stringfy errorMsg inside unhandledrejection callback with exception"+n)}var s={message:""+o,error:r,filename:"",colno:0,lineno:0};if(null!=o&&""!=o||""!=s.error&&null!=s.error||!a.ignoreEmptyErros){var u="";try{u=JSON.stringify(s.error)}catch(n){d("Failed to stringfy exception")}qt(s.message)||qt(u)?l("Ignoring error from unhandled "+o):e(Ft({eventType:Jt(o,t.UnhandledRejection),data:s,isError:!0}))}else l("Ignoring empty errors")},window)),function(){n.forEach(function(e){return e()})}}(At)),o.networkCapture&&(r.push(function(e){function n(t,n){Lt().networkCapture&&(window.stopRecording||function(e,t){try{var n,r=Lt();n=t?r.isIgnoreUrlError:r.ignoreUrl;var o=e.indexOf("?");o>0&&(e=e.substr(0,o));var i=e.toLowerCase();if(n.some(function(e){return i.includes(e.toLowerCase())}))return!0}catch(t){d("Error in url decoding for url : "+e+" Error is - "+t)}return!1}(n.requestUrl,n.status>=400)||e(Ft({eventType:t,data:n,isError:n.status>=400})))}function r(e,t){if("GET"==t||"get"==t)try{var n=e.split("/"),r=n[n.length-1];if(""==r&&n.length>=2&&(r=n[n.length-2]),-1!=r.indexOf(".js")||-1!=r.indexOf(".map")||-1!=r.indexOf(".html")||-1!=r.indexOf(".css"))return u("Going to ignore response text for url "+e),!0}catch(e){return!1}return!1}if(null!=window.zxhrInit||1==window.zxhrInit)return u("Network in already initialized"),function(){};var o=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(){var e="";null!=arguments[1]&&null!=arguments[1]&&("string"==typeof arguments[1]?e=arguments[1]:arguments[1]instanceof URL&&(e=arguments[1].href));var i={request:"",requestMethod:arguments[0]?arguments[0]:"",requestUrl:e,sourceLibrary:"xmlHttpClient",headers:{},response:"",responseHeaders:{},status:400},a=this.send;this.send=function(){a.apply(this,arguments)};var s=this.setRequestHeader;this.setRequestHeader=function(){2!==arguments.length||jt(arguments[0])||(i.headers[arguments[0]]=arguments[1]),s.apply(this,arguments)},this.addEventListener("load",function(){if(!r(e,i.requestMethod))try{this.getAllResponseHeaders().split("\n").forEach(function(e){if(""!==e){var t=e.split(":");i.responseHeaders[t[0]]=t[1].trim()}})}catch(e){l("Error while capturing response text")}i.status=this.status,n(t.XHR,i)}),this.addEventListener("error",function(){try{this.getAllResponseHeaders().split("\n").forEach(function(e){if(""!==e){var t=e.split(":");i.responseHeaders[t[0]]=t[1].trim()}}),i.response=null!=this&&this.responseText?this.responseText:""}catch(e){l("Error while capturing response text")}i.status=this.status?this.status:404,n(t.XHR,i)}),this.addEventListener("abort",function(){try{this.getAllResponseHeaders().split("\n").forEach(function(e){if(""!==e){var t=e.split(":");i.responseHeaders[t[0]]=t[1].trim()}})}catch(e){l("Error while capturing response text")}i.status=this.status?this.status:400,n(t.XHR,i)}),o.apply(this,arguments)};var i=window.fetch;return window.fetch=function(){var e="",o={sourceLibrary:"fetch",requestUrl:"",requestMethod:"",headers:"",request:"",response:"",responseHeaders:{},status:400};null!=arguments[0]&&null!=arguments[0]&&("string"==typeof arguments[0]?e=arguments[0]:arguments[0]instanceof URL&&(e=arguments[0].href)),o={sourceLibrary:"fetch",requestUrl:e||"",requestMethod:arguments[1]&&arguments[1].method?arguments[1].method:"GET",headers:arguments[1]&&arguments[1].headers?Wt(arguments[1].headers):"",request:"",response:"",responseHeaders:{},status:400};var a=i.apply(window,arguments);return new Promise(function(i,s){var u={status:400};a.then(function(e){u={status:e.status};for(var t,n=Et(e.headers);!(t=n()).done;){var r=t.value;r&&(o.responseHeaders[r[0]]=r[1])}return i(e.clone()),e.json()}).then(function(i){!r(e,o.requestMethod)&&u.status>=400&&(o.response=i),o.status=u.status,n(t.XHR,o)}).catch(function(e){o.status=u.status,n(t.XHR,o),s(e)})})},window.zxhrInit=!0,function(){}}(At)),r.push(function(e){var t=[Dt("online",function(t){Vt(e)},window)];return t.push(Dt("offline",function(t){Vt(e)},window)),function(){t.forEach(function(e){return e()})}}(At))),o.webSocketsCapture&&r.push(function(e){function n(n,r){window.stopRecording||e(Ft({eventType:n,data:r,isError:n==t.WSERROR}))}var r=[],o=WebSocket.prototype.send;return WebSocket.prototype.send=function(e){var r={requestUrl:this.url?this.url:"",responseData:{},status:"",protocols:this.protocol,extension:"string"==typeof this.extensions?[this.extensions]:this.extensions,readyState:this.readyState,requestData:arguments[0]?arguments[0]:""};o.apply(this,[e]),this.addEventListener("message",function(e){r.responseData={data:e.data,type:e.type,timestamp:e.timeStamp},n(t.WSMESSAGE,r)}),this.addEventListener("close",function(e){r.responseData={code:e.code,reason:e.reason,type:e.type,timestamp:e.timeStamp},n(t.WSMESSAGE,r)})},function(){r.forEach(function(e){return e()}),WebSocket.prototype.send=o}}(At)),function(){r.forEach(function(e){return e()})}}catch(e){return d(e),function(){}}}({emit:function(e){try{if(e.eventType!=t.Online||window.iszHandshakeDone||(window.ztryForHandshake=!0),window.iszSessionExpired)return void l("Don't store zipy events if session is expired");e.eventType>=t.Error&&e.eventType<=t.UnhandledRejection&&(window.zrrwebRecorderStatus=o.RECORDINGSUCCESSFUL),In({data:JSON.stringify(e.data),time:e.timestamp,type:e.eventType,isError:e.isError,navigatedUrl:window.location.origin+window.location.pathname})}catch(e){d("Failed to store events")}}})}function In(e){var t=Lt();window.zrecordingPaused||kn()&&!tn(t)||window.zEventsData.push(e),window.zlastActivityTime=Date.now()}function En(e,t){var n,r=(null==e?void 0:e.blocked_till)>0?null==e?void 0:e.blocked_till:0,o=r>0?zt()+r:0;n={isBlocked:!(null==e||!e.is_blocked)&&(null==e?void 0:e.is_blocked),apiKey:t,blockedEndTime:o},window.zSessionBlockedInfo=n,function(e){if(e)try{u("Updating zsession-blocked-info"+JSON.stringify(e)),Kt("zsession-blocked-info",JSON.stringify(e))}catch(e){d("Failed to stringify zsession-blocked-info ")}}(n)}function kn(){var e=window.zSessionBlockedInfo||{};return!(null==e||!e.isBlocked)&&e.isBlocked}var Cn=function(e){try{var t,r=function(r){if(t)return r;function s(){function t(t){function r(){On(a.sdkLoopTime,e)}var o=function(){if(t){var r=function(){l("Successfully send data to server via session storage")},o=function(){if(window.zrecordingPaused){window.zrecordingPaused=!1,window.reinitializationInProgress=!0;var t=n.GETUSERCONFIG;return yn()&&(t=n.POSTENDUSERINFOANDGETUSERCONFIG),Promise.resolve(gn(e,t,!1)).then(function(e){i=e,window.zStop=Nn()})}}();return o&&o.then?o.then(r):r()}var a=window.zEventsData||[],s="";try{s=JSON.stringify(a)}catch(e){d("Failed stringify events while stream data server")}0!=i.maxBufferSize&&2*s.length>i.maxBufferSize&&!window.zrecordingPaused&&(window.zrecordingPaused=!0,u("Max Buffer size is reached going to pause recording"))}();return o&&o.then?o.then(r):r()}var r=!window.iszInternetDisconnected&&window.zrrwebRecorderStatus!=o.RECORDINGPENDING;return r?Promise.resolve(wn(e)).then(t):t(r)}var c=function(){if(window.ztryForHandshake)return Promise.resolve(gn(e,window.zpendingOp,!1)).then(function(e){i=e})}();return c&&c.then?c.then(s):s()};if(0==window.sdkInit)return u("Sdk is not initialized yet"),On(a.sdkLoopTime,e),Promise.resolve();if(window.isDataSyncInProgress)return l("Data sync in in progress"),On(a.sdkLoopTime,e),Promise.resolve();if(window.reinitializationInProgress)return l("Reinit is in progress"),On(a.sdkLoopTime,e),Promise.resolve();var i=Lt(),s=function(){if(tn(i)&&window.zEventsData&&window.zEventsData.length>0&&!window.iszInternetDisconnected&&window.zrrwebRecorderStatus!=o.RECORDINGPENDING){u("Session is expired Going to recreate session"),window.reinitializationInProgress=!0,rn(e);var r=n.GETUSERCONFIG;return yn()&&(r=n.POSTENDUSERINFOANDGETUSERCONFIG),Promise.resolve(gn(e,r,!0)).then(function(n){i=n,window.zrecordingPaused=!1,window.zStop=Nn(),On(a.sdkLoopTime,e),t=1})}}();return Promise.resolve(s&&s.then?s.then(r):r(s))}catch(e){return Promise.reject(e)}};function Nn(e){var t=[];try{l("Zipy Recorder Reinit"),window.isDataSyncInProgress=!1;var n=window.zStop;for(window.iszInternetDisconnected=!1,n&&n();window.zEventsData.length;)window.zEventsData.pop();if(window.zEventsData=[],window.stopRecording=!1,Lt().domCapture){var r=Sn();t.push(r)}return t.push(bn()),window.reinitializationInProgress=!1,function(){window.stopRecording=!0,c("Calling zipy Stop Recorder"),t.forEach(function(e){return e()})}}catch(e){d(e)}return function(){}}function On(e,t){setTimeout(Cn,e,t)}e.anonymize=function(){if(window.sdkInit){u("Going to anonymize end user");var e,t=!1;(((e=cn())?e.userType===r.IDENTIFIED:(u("zenduser-info doesn't exists"),0))||function(){var e=dn();return e?e.userType===r.IDENTIFIED:(u("zenduser-info doesn't exists"),!1)}())&&(t=!0);var o=function(){var e=cn();return e?(e.zExternalUserInfo={},e.userType=r.ANONYMS,hn(e,!1),e):(u("zenduser Data dosen't exists"),function(){var e=dn();if(e)return e.zExternalUserInfo={},e.userType=r.ANONYMS,hn(e,!0),e;u("zenduser Data dosen't exists in temp storage")}())}()||{},i=n.GETUSERCONFIG;0===o.euId?(i=n.POSTENDUSERINFOANDGETUSERCONFIG,pn(o),fn(o)):(fn(o),vn());var a=en();a&&t?(window.reinitializationInProgress=!0,rn(null==a?void 0:a.sdkKey),gn(null==a?void 0:a.sdkKey,i,!0).then(function(e){window.zStop=Nn()}).catch(function(e){d("Failed to post/get sdk config from server: ")})):u("Identified user doesn't exists in system No need to break session")}else d("Anonymize: SDK not initialized")},e.getCurrentSessionURL=function(){var e=Lt(),t=Zt("zsession-blocked-info"),n=JSON.parse(t);if(!window.sdkInit||n.is_blocked)return d("SessionLink: SDK not initialized"),"";var r=en()||{},o=Zt("zId");return e.customerId?a.sessionLinkUrl+"/"+r.sdkKey+"/"+e.customerId+"?is_error=false&id="+o+"&euid="+r.sessionId:(d("SessionLink: Could not find customer id"),"")},e.identify=function(e,t){if(void 0===t&&(t={}),window.sdkInit)if(!e||e.length<=0||e.trim().length<=0)d("Got wrong external UUID, Please validate: "+e);else{u("identify :: externalUUId - "+e);var o=cn(),i=en()||{},a=n.POSTENDUSERINFO,s=t;s.externalId=e;var l,c,f=!1;if(o){var p;o.userType==r.ANONYMS||(l=null==(p=o)?void 0:p.zExternalUserInfo,c=s,u("NewEndUserInfo :: "+JSON.stringify(c)),u("PrevEndUserInfo :: "+JSON.stringify(l)),(null==l?void 0:l.externalId)===(null==c?void 0:c.externalId)?a=n.POSTENDUSERINFOANDGETUSERCONFIG:(o.euId=0,o.euZName="",o.userType=r.ANONYMS,o.isBlocked=!1,f=!0,a=n.POSTENDUSERINFOANDGETUSERCONFIG,rn(i.sdkKey),window.reinitializationInProgress=!0))}else{var v=ln();o={euId:0,euZName:"",userType:r.ANONYMS,isBlocked:!1,zExternalUserInfo:{},zAnonymsUserInfo:{zId:v,euId:0,euZName:""}}}window.iszHandshakeDone||(a=n.POSTENDUSERINFOANDGETUSERCONFIG),o.zExternalUserInfo=s,pn(o);var m=Qt();m&&i?!f&&m.isBlocked?u("No need to do backend call if session is blocked"):gn(i.sdkKey,a,f).then(function(e){f&&(window.zStop=Nn())}).catch(function(e){d("Failed to post/get sdk config from server: ")}):d("Value doesn't exists in sessionBlockInfo or sessionData : ")}else d("Identify: SDK not initialized")},e.init=function(e,t){void 0===t&&(t={releaseVer:""});try{s=a.debugLogs;var i=new RegExp(/^[a-zA-Z0-9]{8}$/);return e&&i.test(e)?(window.zRelVer=t.releaseVer,function(){try{for(var e=Object.keys(localStorage),t=0;t<e.length;t++)["zsession-blocked-info","session-data","zId","zenduser-info-temp","zenduser-info","last-activity-time","pack","zsdk-config"].includes(e[t])&&(Bt.set(e[t],localStorage.getItem(e[t])),u("updated value in map is :"+Bt.get(e[t])))}catch(e){d("inside zLocalStorgeMapUpdate catch block ${e.message}")}}(),Promise.resolve(function(e){var t=[];try{for(window.sdkInit=!1,window.isDataSyncInProgress=!1,window.zEventsData=[],window.iszInternetDisconnected=!1,window.zlastActivityTime=Date.now(),window.zrecordingPaused=!1,window.ztryForHandshake=!1,window.iszSessionExpired=!1,window.zrrwebRecorderStatus=o.NORECORDING;window.zEventsData.length;)window.zEventsData.pop();var i=window.sessionStorage.getItem("pending-zEvents");if(u("pendingEvents value is"+i),i)try{var a;a=JSON.parse(i),window.zEventsData=a}catch(e){d("Failed to parse zipyEvents")}var s=Qt();s&&s.apiKey==e||$t(e),l("Zipy Recorder init"),on(e)&&(cn()?(u("Removing enduser-info"),Yt("zenduser-info")):u("zenduser Data dosen't exists"),vn());var f=n.GETUSERCONFIG;if(!cn()&&!dn()){f=n.POSTENDUSERINFOANDGETUSERCONFIG;var p=ln(),v={euId:0,euZName:"",userType:r.ANONYMS,isBlocked:!1,zExternalUserInfo:{},zAnonymsUserInfo:{zId:p,euId:0,euZName:""}};pn(v),fn(v)}yn()&&(f=n.POSTENDUSERINFOANDGETUSERCONFIG);var m=!1;(tn(Xt()||{})||on(e))&&(rn(e),m=!0),gn(e,f,m).then(function(e){if(window.lastSyncTime=0,e.domCapture){var n=Sn();t.push(n)}t.push(bn()),window.zStop=function(){window.stopRecording=!0,c("Calling zipy Stop Recorder"),t.forEach(function(e){return e()})},window.sdkInit=!0}).catch(function(e){window.sdkInit=!0,d("Failed to get get sdk config from server: ")})}catch(e){d(e)}return function(){}}(e)).then(function(){On(a.sdkLoopTime,e)})):(d("Not able to process as sdk api key null or invalid."),Promise.resolve())}catch(e){return Promise.reject(e)}}});
